import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{B as Xe,h as Fe,o as wt,A as Dt,z as Lt,C as It,f as r,Q as Ue,D as Tt,F as ot,G as et,y as Be,ad as At,I as gt,J as mt,K as Ft,ah as yt,a9 as $t,$ as Re,aq as lt,ar as tt,x as ut,as as it,at as ct,au as Pt,ag as Nt,av as Mt,aw as Kt,ax as nt,ay as Ut,a7 as zt,ab as qt,az as bt,aA as Bt,aB as jt,d as Ht,ak as Qt,aj as kt,aC as Wt,p as Je,k as ze,l as Ye,s as A,m as R,_ as fe,an as Jt,n as S,ap as xt,t as xe,aD as Et,aE as St,aF as dt,aG as ft}from"./BQ1Ilsgs.js";import{t as te,b as ee}from"./C0jcebFK.js";import{i as Ge}from"./CPzX5JD1.js";import{o as st}from"./DUIepGDJ.js";import{p as Yt,i as Te,_ as ht}from"./wPes4ITZ.js";import{l as Ct,e as Ae,s as de}from"./ZDHeYt9A.js";import{r as je,s as qe}from"./HaOj0VWS.js";import{b as pt}from"./BgiqfCiA.js";function Me(i,u){return u}function Gt(i,u,d,m){for(var x=[],y=u.length,$=0;$<y;$++)Pt(u[$].e,x,!0);var U=y>0&&x.length===0&&d!==null;if(U){var z=d.parentNode;Nt(z),z.append(d),m.clear(),Pe(i,u[0].prev,u[y-1].next)}Mt(x,()=>{for(var _=0;_<y;_++){var T=u[_];U||(m.delete(T.k),Pe(i,T.prev,T.next)),Kt(T.e,!U)}})}function Ke(i,u,d,m,x,y=null){var $=i,U={flags:u,items:new Map,first:null},z=(u&bt)!==0;if(z){var _=i;$=Fe?Xe(wt(_)):_.appendChild(Dt())}Fe&&Lt();var T=null,J=!1,D=Ue(()=>{var q=d();return $t(q)?q:q==null?[]:yt(q)});It(()=>{var q=r(D),N=q.length;if(J&&N===0)return;J=N===0;let Ee=!1;if(Fe){var oe=$.data===Tt;oe!==(N===0)&&($=ot(),Xe($),et(!1),Ee=!0)}if(Fe){for(var ue=null,he,le=0;le<N;le++){if(Be.nodeType===8&&Be.data===At){$=Be,Ee=!0,et(!1);break}var B=q[le],Q=m(B,le);he=Rt(Be,U,ue,null,B,Q,le,x,u,d),U.items.set(Q,he),ue=he}N>0&&Xe(ot())}Fe||Vt(q,U,$,x,u,m,d),y!==null&&(N===0?T?gt(T):T=mt(()=>y($)):T!==null&&Ft(T,()=>{T=null})),Ee&&et(!0),r(D)}),Fe&&($=Be)}function Vt(i,u,d,m,x,y,$){var j,h,n,c;var U=(x&Bt)!==0,z=(x&(nt|it))!==0,_=i.length,T=u.items,J=u.first,D=J,q,N=null,Ee,oe=[],ue=[],he,le,B,Q;if(U)for(Q=0;Q<_;Q+=1)he=i[Q],le=y(he,Q),B=T.get(le),B!==void 0&&((j=B.a)==null||j.measure(),(Ee??(Ee=new Set)).add(B));for(Q=0;Q<_;Q+=1){if(he=i[Q],le=y(he,Q),B=T.get(le),B===void 0){var Se=D?D.e.nodes_start:d;N=Rt(Se,u,N,N===null?u.first:N.next,he,le,Q,m,x,$),T.set(le,N),oe=[],ue=[],D=N.next;continue}if(z&&Zt(B,he,Q,x),(B.e.f&tt)!==0&&(gt(B.e),U&&((h=B.a)==null||h.unfix(),(Ee??(Ee=new Set)).delete(B))),B!==D){if(q!==void 0&&q.has(B)){if(oe.length<ue.length){var W=ue[0],e;N=W.prev;var t=oe[0],a=oe[oe.length-1];for(e=0;e<oe.length;e+=1)vt(oe[e],W,d);for(e=0;e<ue.length;e+=1)q.delete(ue[e]);Pe(u,t.prev,a.next),Pe(u,N,t),Pe(u,a,W),D=W,N=a,Q-=1,oe=[],ue=[]}else q.delete(B),vt(B,D,d),Pe(u,B.prev,B.next),Pe(u,B,N===null?u.first:N.next),Pe(u,N,B),N=B;continue}for(oe=[],ue=[];D!==null&&D.k!==le;)(D.e.f&tt)===0&&(q??(q=new Set)).add(D),ue.push(D),D=D.next;if(D===null)continue;B=D}oe.push(B),N=B,D=B.next}if(D!==null||q!==void 0){for(var f=q===void 0?[]:yt(q);D!==null;)(D.e.f&tt)===0&&f.push(D),D=D.next;var g=f.length;if(g>0){var v=(x&bt)!==0&&_===0?d:null;if(U){for(Q=0;Q<g;Q+=1)(n=f[Q].a)==null||n.measure();for(Q=0;Q<g;Q+=1)(c=f[Q].a)==null||c.fix()}Gt(u,f,v,T)}}U&&zt(()=>{var b;if(Ee!==void 0)for(B of Ee)(b=B.a)==null||b.apply()}),ut.first=u.first&&u.first.e,ut.last=N&&N.e}function Zt(i,u,d,m){(m&nt)!==0&&ct(i.v,u),(m&it)!==0?ct(i.i,d):i.i=d}function Rt(i,u,d,m,x,y,$,U,z,_){var T=(z&nt)!==0,J=(z&Ut)===0,D=T?J?Re(x):lt(x):x,q=(z&it)===0?$:lt($),N={i:q,v:D,k:y,a:null,e:null,prev:d,next:m};try{return N.e=mt(()=>U(i,D,q,_),Fe),N.e.prev=d&&d.e,N.e.next=m&&m.e,d===null?u.first=N:(d.next=N,d.e.next=N.e),m!==null&&(m.prev=N,m.e.prev=N.e),N}finally{}}function vt(i,u,d){for(var m=i.next?i.next.e.nodes_start:d,x=u?u.e.nodes_start:d,y=i.e.nodes_start;y!==m;){var $=qt(y);x.before(y),y=$}}function Pe(i,u,d){u===null?i.first=d:(u.next=d,u.e.next=d&&d.e),d!==null&&(d.prev=u,d.e.prev=u&&u.e)}function Xt(i,u){return i==null?null:String(i)}function er(i,u,d,m){var x=i.__style;if(Fe||x!==u){var y=Xt(u);(!Fe||y!==i.getAttribute("style"))&&(y==null?i.removeAttribute("style"):i.style.cssText=y),i.__style=u}return m}function He(i,u,d=u){var m=jt();Ct(i,"input",x=>{var y=x?i.defaultValue:i.value;if(y=rt(i)?at(y):y,d(y),m&&y!==(y=u())){var $=i.selectionStart,U=i.selectionEnd;i.value=y??"",U!==null&&(i.selectionStart=$,i.selectionEnd=Math.min(U,i.value.length))}}),(Fe&&i.defaultValue!==i.value||Ht(u)==null&&i.value)&&d(rt(i)?at(i.value):i.value),Qt(()=>{var x=u();rt(i)&&x===at(i.value)||i.type==="date"&&!x&&!i.value||x!==i.value&&(i.value=x??"")})}function rt(i){var u=i.type;return u==="number"||u==="range"}function at(i){return i===""?null:+i}function Ot(i,u,d){if(i.multiple)return ar(i,u);for(var m of i.options){var x=Qe(m);if(Wt(x,u)){m.selected=!0;return}}(!d||u!==void 0)&&(i.selectedIndex=-1)}function tr(i,u){kt(()=>{var d=new MutationObserver(()=>{var m=i.__value;Ot(i,m)});return d.observe(i,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{d.disconnect()}})}function rr(i,u,d=u){var m=!0;Ct(i,"change",x=>{var y=x?"[selected]":":checked",$;if(i.multiple)$=[].map.call(i.querySelectorAll(y),Qe);else{var U=i.querySelector(y)??i.querySelector("option:not([disabled])");$=U&&Qe(U)}d($)}),kt(()=>{var x=u();if(Ot(i,x,m),m&&x===void 0){var y=i.querySelector(":checked");y!==null&&(x=Qe(y),d(x))}i.__value=x,m=!1}),tr(i)}function ar(i,u){for(var d of i.options)d.selected=~u.indexOf(Qe(d))}function Qe(i){return"__value"in i?i.__value:i.value}function ir(i){return function(...u){var d=u[0];return d.preventDefault(),i==null?void 0:i.apply(this,u)}}var nr=te('<div class="controller__stop svelte-1or32pp"><img alt="Stop Icon" width="24" height="24"> <span class="svelte-1or32pp"> </span> <button type="button" class="controller__remove svelte-1or32pp" aria-label="Remove stop">âœ•</button></div>'),sr=te('<div class="controller__stops svelte-1or32pp"></div>'),or=te('<div class="opener svelte-1or32pp"><a class="opener__link svelte-1or32pp" target="_blank" rel="noopener noreferrer"><button class="opener__button svelte-1or32pp">Open in Google Maps</button></a> <a class="opener__link svelte-1or32pp" target="_blank" rel="noopener noreferrer"><button class="opener__button svelte-1or32pp">Open in Apple Maps</button></a></div>'),lr=te('<form class="controller svelte-1or32pp"><div class="controller__section svelte-1or32pp"><label class="controller__label svelte-1or32pp">Start:</label> <input class="controller__input svelte-1or32pp" type="text" placeholder="Your location or address"></div> <!> <div class="controller__section svelte-1or32pp"><label class="controller__label svelte-1or32pp">End:</label> <input class="controller__input svelte-1or32pp" type="text" placeholder="Type address or store name"></div> <button class="controller__submit svelte-1or32pp" type="submit">Go!</button></form> <div id="map" class="map svelte-1or32pp"></div> <!>',1);function ur(i,u){Je(u,!1);let d,m,x=[],y=null,$=Re(""),U=Re(""),z=Re("ðŸ“ Your Location"),_=Re(""),T=null,J=null,D=null,q=Re([]);const N={Discount365:"Coop_Marker","Rema 1000":"Rema_Marker"};let Ee=Yt(u,"onRouteCreated",8,()=>{});async function oe(v){const h=await(await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(v)}&format=json&limit=1`)).json();return h.length===0?null:{lat:parseFloat(h[0].lat),lng:parseFloat(h[0].lon)}}function ue(v){if(!v)return"Unknown";const j=v.toLowerCase();return j.includes("discount")?"Discount365":j.includes("rema")?"Rema 1000":"Other"}async function he(){if(!d)return;if(r(z)==="ðŸ“ Your Location"){if(!y)return;T=L.latLng(y.lat,y.lng)}else{const n=await oe(r(z));if(!n)return;T=L.latLng(n.lat,n.lng)}if(!r(_))return;const v=await oe(r(_));if(!v)return;J=L.latLng(v.lat,v.lng),m&&d.removeControl(m);const j=[T,...r(q).map(n=>n.coord)];J&&j.push(J),m=L.Routing.control({waypoints:j,routeWhileDragging:!0}).addTo(d),fe($,"https://www.google.com/maps/dir/"+[T,...r(q).map(n=>n.coord),J].filter(Boolean).map(n=>`${n.lat},${n.lng}`).join("/")),fe(U,`https://maps.apple.com/?saddr=${T.lat},${T.lng}&daddr=${J.lat},${J.lng}`);let h=[T,...r(q).map(n=>n.coord),J].filter(Boolean);h.length>=2&&fe(U,`https://maps.apple.com/?saddr=${h[0].lat},${h[0].lng}&daddr=${h.slice(1).map(n=>`${n.lat},${n.lng}`).join("+to:")}`),Ee()({start:T,end:J})}st(async()=>{const v=await ht(()=>import("./INr66ZBr.js").then(n=>n.l),[],import.meta.url);window.L=v,await ht(()=>import("./Bgcq9nrZ.js").then(n=>n.l),[],import.meta.url),d=v.map("map").setView([55.6761,12.5683],13),v.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(d),d.locate({setView:!0,maxZoom:14}),d.on("locationfound",n=>{y=n.latlng,console.log("User location found:",y),D?D.setLatLng(y):D=v.circleMarker(y,{radius:8,color:"#1976d2",fillColor:"#2196f3",fillOpacity:.8,weight:2}).addTo(d).bindTooltip("You are here",{permanent:!1,direction:"top"}),he()}),x=(await(await fetch("/data/stores.json")).json()).features.filter(n=>{var c;return((c=n.geometry)==null?void 0:c.type)==="Point"}).map(n=>{var s,k;const[c,b]=n.geometry.coordinates,l=((s=n.properties)==null?void 0:s.name)||"Unknown",P=((k=n.properties)==null?void 0:k.branch)||"",p=ue(l);return{name:P?`${p} ${P}`:l,lat:b,lng:c,chain:p}}).filter(n=>n.chain==="Discount365"||n.chain==="Rema 1000"),x.forEach(n=>{const c=v.divIcon({className:"icon",html:`
				<img
					class="icon__image"
					src="${pt}/images/${N[n.chain]}.png"
					height=48 width=48
					style="
						position:absolute;
						bottom: 0;
						left: 50%;
						transform: translateX(-50%);
					"
				>`}),b=v.marker([n.lat,n.lng],{icon:c}).addTo(d);b.on("click",()=>{const l=v.latLng(n.lat,n.lng);fe(q,[...r(q),{name:n.name,coord:l}]),he()}),b.bindTooltip(`Set Waypoint: ${n.name}`,{permanent:!1,direction:"top"})}),await Jt(),he()}),Ge();var le=lr(),B=ze(le),Q=R(B),Se=A(R(Q),2);je(Se),S(Q);var W=A(Q,2);{var e=v=>{var j=sr();Ke(j,5,()=>r(q),Me,(h,n,c)=>{var b=nr(),l=R(b),P=A(l,2),p=R(P,!0);S(P);var E=A(P,2);S(b),xe(s=>{qe(l,"src",s),de(p,r(n).name)},[()=>`${pt}/images/${N[ue(r(n).name)]}.png`],Ue),Ae("click",E,()=>{r(q).splice(c,1),he()}),ee(h,b)}),S(j),ee(v,j)};Te(W,v=>{r(q).length>0&&v(e)})}var t=A(W,2),a=A(R(t),2);je(a),S(t),xt(2),S(B);var f=A(B,4);{var g=v=>{var j=or(),h=R(j),n=A(h,2);S(j),xe(()=>{qe(h,"href",r($)),qe(n,"href",r(U))}),ee(v,j)};Te(f,v=>{r($)&&r(U)&&v(g)})}He(Se,()=>r(z),v=>fe(z,v)),He(a,()=>r(_),v=>fe(_,v)),Ae("submit",B,ir(he)),ee(i,le),Ye()}var Yr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function cr(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var We={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var dr=We.exports,_t;function fr(){return _t||(_t=1,function(i,u){((d,m)=>{i.exports=m()})(dr,function d(){var m=typeof self<"u"?self:typeof window<"u"?window:m!==void 0?m:{},x,y=!m.document&&!!m.postMessage,$=m.IS_PAPA_WORKER||!1,U={},z=0,_={};function T(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var a=Q(t);a.chunkSize=parseInt(a.chunkSize),t.step||t.chunk||(a.chunkSize=null),this._handle=new Ee(a),(this._handle.streamer=this)._config=a}).call(this,e),this.parseChunk=function(t,a){var f=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<f){let v=this._config.newline;v||(g=this._config.quoteChar||'"',v=this._handle.guessLineEndings(t,g)),t=[...t.split(v).slice(f)].join(v)}this.isFirstChunk&&W(this._config.beforeFirstChunk)&&(g=this._config.beforeFirstChunk(t))!==void 0&&(t=g),this.isFirstChunk=!1,this._halted=!1;var f=this._partialLine+t,g=(this._partialLine="",this._handle.parse(f,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=g.meta.cursor,f=(this._finished||(this._partialLine=f.substring(t-this._baseIndex),this._baseIndex=t),g&&g.data&&(this._rowCount+=g.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),$)m.postMessage({results:g,workerId:_.WORKER_ID,finished:f});else if(W(this._config.chunk)&&!a){if(this._config.chunk(g,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=g=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(g.data),this._completeResults.errors=this._completeResults.errors.concat(g.errors),this._completeResults.meta=g.meta),this._completed||!f||!W(this._config.complete)||g&&g.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),f||g&&g.meta.paused||this._nextChunk(),g}this._halted=!0},this._sendError=function(t){W(this._config.error)?this._config.error(t):$&&this._config.error&&m.postMessage({workerId:_.WORKER_ID,error:t,finished:!1})}}function J(e){var t;(e=e||{}).chunkSize||(e.chunkSize=_.RemoteChunkSize),T.call(this,e),this._nextChunk=y?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(a){this._input=a,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),y||(t.onload=Se(this._chunkLoaded,this),t.onerror=Se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!y),this._config.downloadRequestHeaders){var a,f=this._config.downloadRequestHeaders;for(a in f)t.setRequestHeader(a,f[a])}var g;this._config.chunkSize&&(g=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+g));try{t.send(this._config.downloadRequestBody)}catch(v){this._chunkError(v.message)}y&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(a=>(a=a.getResponseHeader("Content-Range"))!==null?parseInt(a.substring(a.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(a){a=t.statusText||a,this._sendError(new Error(a))}}function D(e){(e=e||{}).chunkSize||(e.chunkSize=_.LocalChunkSize),T.call(this,e);var t,a,f=typeof FileReader<"u";this.stream=function(g){this._input=g,a=g.slice||g.webkitSlice||g.mozSlice,f?((t=new FileReader).onload=Se(this._chunkLoaded,this),t.onerror=Se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var g=this._input,v=(this._config.chunkSize&&(v=Math.min(this._start+this._config.chunkSize,this._input.size),g=a.call(g,this._start,v)),t.readAsText(g,this._config.encoding));f||this._chunkLoaded({target:{result:v}})},this._chunkLoaded=function(g){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(g.target.result)},this._chunkError=function(){this._sendError(t.error)}}function q(e){var t;T.call(this,e=e||{}),this.stream=function(a){return t=a,this._nextChunk()},this._nextChunk=function(){var a,f;if(!this._finished)return a=this._config.chunkSize,t=a?(f=t.substring(0,a),t.substring(a)):(f=t,""),this._finished=!t,this.parseChunk(f)}}function N(e){T.call(this,e=e||{});var t=[],a=!0,f=!1;this.pause=function(){T.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){T.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(g){this._input=g,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){f&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):a=!0},this._streamData=Se(function(g){try{t.push(typeof g=="string"?g:g.toString(this._config.encoding)),a&&(a=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(v){this._streamError(v)}},this),this._streamError=Se(function(g){this._streamCleanUp(),this._sendError(g)},this),this._streamEnd=Se(function(){this._streamCleanUp(),f=!0,this._streamData("")},this),this._streamCleanUp=Se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Ee(e){var t,a,f,g,v=Math.pow(2,53),j=-v,h=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,n=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,c=this,b=0,l=0,P=!1,p=!1,E=[],s={data:[],errors:[],meta:{}};function k(C){return e.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function O(){if(s&&f&&(K("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+_.DefaultDelimiter+"'"),f=!1),e.skipEmptyLines&&(s.data=s.data.filter(function(w){return!k(w)})),F()){let w=function(Y,re){W(e.transformHeader)&&(Y=e.transformHeader(Y,re)),E.push(Y)};if(s)if(Array.isArray(s.data[0])){for(var C=0;F()&&C<s.data.length;C++)s.data[C].forEach(w);s.data.splice(0,1)}else s.data.forEach(w)}function I(w,Y){for(var re=e.header?{}:[],G=0;G<w.length;G++){var V=G,H=w[G],H=((me,M)=>(Z=>(e.dynamicTypingFunction&&e.dynamicTyping[Z]===void 0&&(e.dynamicTyping[Z]=e.dynamicTypingFunction(Z)),(e.dynamicTyping[Z]||e.dynamicTyping)===!0))(me)?M==="true"||M==="TRUE"||M!=="false"&&M!=="FALSE"&&((Z=>{if(h.test(Z)&&(Z=parseFloat(Z),j<Z&&Z<v))return 1})(M)?parseFloat(M):n.test(M)?new Date(M):M===""?null:M):M)(V=e.header?G>=E.length?"__parsed_extra":E[G]:V,H=e.transform?e.transform(H,V):H);V==="__parsed_extra"?(re[V]=re[V]||[],re[V].push(H)):re[V]=H}return e.header&&(G>E.length?K("FieldMismatch","TooManyFields","Too many fields: expected "+E.length+" fields but parsed "+G,l+Y):G<E.length&&K("FieldMismatch","TooFewFields","Too few fields: expected "+E.length+" fields but parsed "+G,l+Y)),re}var o;s&&(e.header||e.dynamicTyping||e.transform)&&(o=1,!s.data.length||Array.isArray(s.data[0])?(s.data=s.data.map(I),o=s.data.length):s.data=I(s.data,0),e.header&&s.meta&&(s.meta.fields=E),l+=o)}function F(){return e.header&&E.length===0}function K(C,I,o,w){C={type:C,code:I,message:o},w!==void 0&&(C.row=w),s.errors.push(C)}W(e.step)&&(g=e.step,e.step=function(C){s=C,F()?O():(O(),s.data.length!==0&&(b+=C.data.length,e.preview&&b>e.preview?a.abort():(s.data=s.data[0],g(s,c))))}),this.parse=function(C,I,o){var w=e.quoteChar||'"',w=(e.newline||(e.newline=this.guessLineEndings(C,w)),f=!1,e.delimiter?W(e.delimiter)&&(e.delimiter=e.delimiter(C),s.meta.delimiter=e.delimiter):((w=((Y,re,G,V,H)=>{var me,M,Z,ne;H=H||[",","	","|",";",_.RECORD_SEP,_.UNIT_SEP];for(var pe=0;pe<H.length;pe++){for(var ve,Oe=H[pe],se=0,ye=0,X=0,ce=(Z=void 0,new ue({comments:V,delimiter:Oe,newline:re,preview:10}).parse(Y)),_e=0;_e<ce.data.length;_e++)G&&k(ce.data[_e])?X++:(ve=ce.data[_e].length,ye+=ve,Z===void 0?Z=ve:0<ve&&(se+=Math.abs(ve-Z),Z=ve));0<ce.data.length&&(ye/=ce.data.length-X),(M===void 0||se<=M)&&(ne===void 0||ne<ye)&&1.99<ye&&(M=se,me=Oe,ne=ye)}return{successful:!!(e.delimiter=me),bestDelimiter:me}})(C,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=w.bestDelimiter:(f=!0,e.delimiter=_.DefaultDelimiter),s.meta.delimiter=e.delimiter),Q(e));return e.preview&&e.header&&w.preview++,t=C,a=new ue(w),s=a.parse(t,I,o),O(),P?{meta:{paused:!0}}:s||{meta:{paused:!1}}},this.paused=function(){return P},this.pause=function(){P=!0,a.abort(),t=W(e.chunk)?"":t.substring(a.getCharIndex())},this.resume=function(){c.streamer._halted?(P=!1,c.streamer.parseChunk(t,!0)):setTimeout(c.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,a.abort(),s.meta.aborted=!0,W(e.complete)&&e.complete(s),t=""},this.guessLineEndings=function(Y,w){Y=Y.substring(0,1048576);var w=new RegExp(oe(w)+"([^]*?)"+oe(w),"gm"),o=(Y=Y.replace(w,"")).split("\r"),w=Y.split(`
`),Y=1<w.length&&w[0].length<o[0].length;if(o.length===1||Y)return`
`;for(var re=0,G=0;G<o.length;G++)o[G][0]===`
`&&re++;return re>=o.length/2?`\r
`:"\r"}}function oe(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ue(e){var t=(e=e||{}).delimiter,a=e.newline,f=e.comments,g=e.step,v=e.preview,j=e.fastMode,h=null,n=!1,c=e.quoteChar==null?'"':e.quoteChar,b=c;if(e.escapeChar!==void 0&&(b=e.escapeChar),(typeof t!="string"||-1<_.BAD_DELIMITERS.indexOf(t))&&(t=","),f===t)throw new Error("Comment character same as delimiter");f===!0?f="#":(typeof f!="string"||-1<_.BAD_DELIMITERS.indexOf(f))&&(f=!1),a!==`
`&&a!=="\r"&&a!==`\r
`&&(a=`
`);var l=0,P=!1;this.parse=function(p,E,s){if(typeof p!="string")throw new Error("Input must be a string");var k=p.length,O=t.length,F=a.length,K=f.length,C=W(g),I=[],o=[],w=[],Y=l=0;if(!p)return se();if(j||j!==!1&&p.indexOf(c)===-1){for(var re=p.split(a),G=0;G<re.length;G++){if(w=re[G],l+=w.length,G!==re.length-1)l+=a.length;else if(s)return se();if(!f||w.substring(0,K)!==f){if(C){if(I=[],ne(w.split(t)),ye(),P)return se()}else ne(w.split(t));if(v&&v<=G)return I=I.slice(0,v),se(!0)}}return se()}for(var V=p.indexOf(t,l),H=p.indexOf(a,l),me=new RegExp(oe(b)+oe(c),"g"),M=p.indexOf(c,l);;)if(p[l]===c)for(M=l,l++;;){if((M=p.indexOf(c,M+1))===-1)return s||o.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:I.length,index:l}),ve();if(M===k-1)return ve(p.substring(l,M).replace(me,c));if(c===b&&p[M+1]===b)M++;else if(c===b||M===0||p[M-1]!==b){V!==-1&&V<M+1&&(V=p.indexOf(t,M+1));var Z=pe((H=H!==-1&&H<M+1?p.indexOf(a,M+1):H)===-1?V:Math.min(V,H));if(p.substr(M+1+Z,O)===t){w.push(p.substring(l,M).replace(me,c)),p[l=M+1+Z+O]!==c&&(M=p.indexOf(c,l)),V=p.indexOf(t,l),H=p.indexOf(a,l);break}if(Z=pe(H),p.substring(M+1+Z,M+1+Z+F)===a){if(w.push(p.substring(l,M).replace(me,c)),Oe(M+1+Z+F),V=p.indexOf(t,l),M=p.indexOf(c,l),C&&(ye(),P))return se();if(v&&I.length>=v)return se(!0);break}o.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:I.length,index:l}),M++}}else if(f&&w.length===0&&p.substring(l,l+K)===f){if(H===-1)return se();l=H+F,H=p.indexOf(a,l),V=p.indexOf(t,l)}else if(V!==-1&&(V<H||H===-1))w.push(p.substring(l,V)),l=V+O,V=p.indexOf(t,l);else{if(H===-1)break;if(w.push(p.substring(l,H)),Oe(H+F),C&&(ye(),P))return se();if(v&&I.length>=v)return se(!0)}return ve();function ne(X){I.push(X),Y=l}function pe(X){var ce=0;return ce=X!==-1&&(X=p.substring(M+1,X))&&X.trim()===""?X.length:ce}function ve(X){return s||(X===void 0&&(X=p.substring(l)),w.push(X),l=k,ne(w),C&&ye()),se()}function Oe(X){l=X,ne(w),w=[],H=p.indexOf(a,l)}function se(X){if(e.header&&!E&&I.length&&!n){var ce=I[0],_e=Object.create(null),ge=new Set(ce);let we=!1;for(let Ie=0;Ie<ce.length;Ie++){let ke=ce[Ie];if(_e[ke=W(e.transformHeader)?e.transformHeader(ke,Ie):ke]){let De,Ce=_e[ke];for(;De=ke+"_"+Ce,Ce++,ge.has(De););ge.add(De),ce[Ie]=De,_e[ke]++,we=!0,(h=h===null?{}:h)[De]=ke}else _e[ke]=1,ce[Ie]=ke;ge.add(ke)}we&&console.warn("Duplicate headers found and renamed."),n=!0}return{data:I,errors:o,meta:{delimiter:t,linebreak:a,aborted:P,truncated:!!X,cursor:Y+(E||0),renamedHeaders:h}}}function ye(){g(se()),I=[],o=[]}},this.abort=function(){P=!0},this.getCharIndex=function(){return l}}function he(e){var t=e.data,a=U[t.workerId],f=!1;if(t.error)a.userError(t.error,t.file);else if(t.results&&t.results.data){var g={abort:function(){f=!0,le(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:B,resume:B};if(W(a.userStep)){for(var v=0;v<t.results.data.length&&(a.userStep({data:t.results.data[v],errors:t.results.errors,meta:t.results.meta},g),!f);v++);delete t.results}else W(a.userChunk)&&(a.userChunk(t.results,g,t.file),delete t.results)}t.finished&&!f&&le(t.workerId,t.results)}function le(e,t){var a=U[e];W(a.userComplete)&&a.userComplete(t),a.terminate(),delete U[e]}function B(){throw new Error("Not implemented.")}function Q(e){if(typeof e!="object"||e===null)return e;var t,a=Array.isArray(e)?[]:{};for(t in e)a[t]=Q(e[t]);return a}function Se(e,t){return function(){e.apply(t,arguments)}}function W(e){return typeof e=="function"}return _.parse=function(e,t){var a=(t=t||{}).dynamicTyping||!1;if(W(a)&&(t.dynamicTypingFunction=a,a={}),t.dynamicTyping=a,t.transform=!!W(t.transform)&&t.transform,!t.worker||!_.WORKERS_SUPPORTED)return a=null,_.NODE_STREAM_INPUT,typeof e=="string"?(e=(f=>f.charCodeAt(0)!==65279?f:f.slice(1))(e),a=new(t.download?J:q)(t)):e.readable===!0&&W(e.read)&&W(e.on)?a=new N(t):(m.File&&e instanceof File||e instanceof Object)&&(a=new D(t)),a.stream(e);(a=(()=>{var f;return!!_.WORKERS_SUPPORTED&&(f=(()=>{var g=m.URL||m.webkitURL||null,v=d.toString();return _.BLOB_URL||(_.BLOB_URL=g.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",v,")();"],{type:"text/javascript"})))})(),(f=new m.Worker(f)).onmessage=he,f.id=z++,U[f.id]=f)})()).userStep=t.step,a.userChunk=t.chunk,a.userComplete=t.complete,a.userError=t.error,t.step=W(t.step),t.chunk=W(t.chunk),t.complete=W(t.complete),t.error=W(t.error),delete t.worker,a.postMessage({input:e,config:t,workerId:a.id})},_.unparse=function(e,t){var a=!1,f=!0,g=",",v=`\r
`,j='"',h=j+j,n=!1,c=null,b=!1,l=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||_.BAD_DELIMITERS.filter(function(E){return t.delimiter.indexOf(E)!==-1}).length||(g=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(a=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(n=t.skipEmptyLines),typeof t.newline=="string"&&(v=t.newline),typeof t.quoteChar=="string"&&(j=t.quoteChar),typeof t.header=="boolean"&&(f=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");c=t.columns}t.escapeChar!==void 0&&(h=t.escapeChar+j),t.escapeFormulae instanceof RegExp?b=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(b=/^[=+\-@\t\r].*$/)}})(),new RegExp(oe(j),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return P(null,e,n);if(typeof e[0]=="object")return P(c||Object.keys(e[0]),e,n)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),P(e.fields||[],e.data||[],n);throw new Error("Unable to serialize unrecognized input");function P(E,s,k){var O="",F=(typeof E=="string"&&(E=JSON.parse(E)),typeof s=="string"&&(s=JSON.parse(s)),Array.isArray(E)&&0<E.length),K=!Array.isArray(s[0]);if(F&&f){for(var C=0;C<E.length;C++)0<C&&(O+=g),O+=p(E[C],C);0<s.length&&(O+=v)}for(var I=0;I<s.length;I++){var o=(F?E:s[I]).length,w=!1,Y=F?Object.keys(s[I]).length===0:s[I].length===0;if(k&&!F&&(w=k==="greedy"?s[I].join("").trim()==="":s[I].length===1&&s[I][0].length===0),k==="greedy"&&F){for(var re=[],G=0;G<o;G++){var V=K?E[G]:G;re.push(s[I][V])}w=re.join("").trim()===""}if(!w){for(var H=0;H<o;H++){0<H&&!Y&&(O+=g);var me=F&&K?E[H]:H;O+=p(s[I][me],H)}I<s.length-1&&(!k||0<o&&!Y)&&(O+=v)}}return O}function p(E,s){var k,O;return E==null?"":E.constructor===Date?JSON.stringify(E).slice(1,25):(O=!1,b&&typeof E=="string"&&b.test(E)&&(E="'"+E,O=!0),k=E.toString().replace(l,h),(O=O||a===!0||typeof a=="function"&&a(E,s)||Array.isArray(a)&&a[s]||((F,K)=>{for(var C=0;C<K.length;C++)if(-1<F.indexOf(K[C]))return!0;return!1})(k,_.BAD_DELIMITERS)||-1<k.indexOf(g)||k.charAt(0)===" "||k.charAt(k.length-1)===" ")?j+k+j:k)}},_.RECORD_SEP="",_.UNIT_SEP="",_.BYTE_ORDER_MARK="\uFEFF",_.BAD_DELIMITERS=["\r",`
`,'"',_.BYTE_ORDER_MARK],_.WORKERS_SUPPORTED=!y&&!!m.Worker,_.NODE_STREAM_INPUT=1,_.LocalChunkSize=10485760,_.RemoteChunkSize=5242880,_.DefaultDelimiter=",",_.Parser=ue,_.ParserHandle=Ee,_.NetworkStreamer=J,_.FileStreamer=D,_.StringStreamer=q,_.ReadableStreamStreamer=N,m.jQuery&&((x=m.jQuery).fn.parse=function(e){var t=e.config||{},a=[];return this.each(function(v){if(!(x(this).prop("tagName").toUpperCase()==="INPUT"&&x(this).attr("type").toLowerCase()==="file"&&m.FileReader)||!this.files||this.files.length===0)return!0;for(var j=0;j<this.files.length;j++)a.push({file:this.files[j],inputElem:this,instanceConfig:x.extend({},t)})}),f(),this;function f(){if(a.length===0)W(e.complete)&&e.complete();else{var v,j,h,n,c=a[0];if(W(e.before)){var b=e.before(c.file,c.inputElem);if(typeof b=="object"){if(b.action==="abort")return v="AbortError",j=c.file,h=c.inputElem,n=b.reason,void(W(e.error)&&e.error({name:v},j,h,n));if(b.action==="skip")return void g();typeof b.config=="object"&&(c.instanceConfig=x.extend(c.instanceConfig,b.config))}else if(b==="skip")return void g()}var l=c.instanceConfig.complete;c.instanceConfig.complete=function(P){W(l)&&l(P,c.file,c.inputElem),g()},_.parse(c.file,c.instanceConfig)}}function g(){a.splice(0,1),f()}}),$&&(m.onmessage=function(e){e=e.data,_.WORKER_ID===void 0&&e&&(_.WORKER_ID=e.workerId),typeof e.input=="string"?m.postMessage({workerId:_.WORKER_ID,results:_.parse(e.input,e.config),finished:!0}):(m.File&&e.input instanceof File||e.input instanceof Object)&&(e=_.parse(e.input,e.config))&&m.postMessage({workerId:_.WORKER_ID,results:e,finished:!0})}),(J.prototype=Object.create(T.prototype)).constructor=J,(D.prototype=Object.create(T.prototype)).constructor=D,(q.prototype=Object.create(q.prototype)).constructor=q,(N.prototype=Object.create(T.prototype)).constructor=N,_})}(We)),We.exports}var hr=fr();const pr=cr(hr);var vr=te('<li class="svelte-bfi8cr"> </li>'),_r=te('<ul class="suggestions svelte-bfi8cr"></ul>'),gr=te('<img alt="Product" width="80" class="svelte-bfi8cr">'),mr=te("<i>No image</i>"),yr=te('<tr><td class="svelte-bfi8cr"><!></td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"><input type="number" min="0" step="1" style="width: 80px" class="svelte-bfi8cr"> <span> </span></td><td class="svelte-bfi8cr"><button>Del</button></td></tr>'),br=te('<img width="60" alt="Image" class="svelte-bfi8cr">'),kr=te("<i>No image</i>"),xr=te("<option> </option>"),Er=te('<td class="svelte-bfi8cr"><!></td> <td class="svelte-bfi8cr"> </td> <td class="svelte-bfi8cr"> <strong> </strong></td> <td class="svelte-bfi8cr"><select><option> </option><!></select></td>',1),Sr=te('<td colspan="3" class="svelte-bfi8cr"><i>Not available</i></td>'),Cr=te('<img width="60" alt="Image" class="svelte-bfi8cr">'),Rr=te("<i>No image</i>"),Or=te("<option> </option>"),wr=te('<td class="svelte-bfi8cr"><!></td> <td class="svelte-bfi8cr"> </td> <td class="svelte-bfi8cr"> <strong> </strong></td> <td class="svelte-bfi8cr"><select><option> </option><!></select></td>',1),Dr=te('<td colspan="4" class="svelte-bfi8cr"><i>Not available</i></td>'),Lr=te('<tr><td class="svelte-bfi8cr"> </td><!><!></tr>'),Ir=te('<table class="product-table svelte-bfi8cr"><thead><tr><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Category</th><th class="svelte-bfi8cr">Price Range</th><th class="svelte-bfi8cr">Price per Unit</th><th class="svelte-bfi8cr">Quantity</th><th class="svelte-bfi8cr"></th></tr></thead><tbody></tbody></table> <table class="comparison-table svelte-bfi8cr"><thead><tr><th rowspan="2" class="svelte-bfi8cr">Product</th><th colspan="4" class="svelte-bfi8cr">Rema1000</th><th colspan="4" class="svelte-bfi8cr">Coop</th></tr><tr><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Product</th><th class="svelte-bfi8cr">Price Ã— Qty</th><th class="svelte-bfi8cr"></th><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Product</th><th class="svelte-bfi8cr">Price Ã— Qty</th><th class="svelte-bfi8cr"></th></tr></thead><tbody><!><tr><th class="svelte-bfi8cr">Total</th><td colspan="3" class="svelte-bfi8cr"></td><td class="svelte-bfi8cr"><strong> </strong></td><td colspan="3" class="svelte-bfi8cr"></td><td class="svelte-bfi8cr"><strong> </strong></td></tr></tbody></table>',1),Tr=te("<option> </option>"),Ar=te('<div class="basket-controls svelte-bfi8cr"><select><option disabled selected>Select saved basket</option><!></select> <button>Load Basket</button> <button>Delete Basket</button></div>'),Fr=te('<div class="autocomplete svelte-bfi8cr"><input type="text" placeholder="Add grocery category..." class="svelte-bfi8cr"> <!></div> <!> <hr> <h3>Manage Baskets</h3> <div class="basket-controls svelte-bfi8cr"><input type="text" placeholder="Basket name (e.g. Week 22)" class="svelte-bfi8cr"> <button>Save Current Basket</button></div> <!>',1);function $r(i,u){Je(u,!1);const d=Re();let m=[],x=Re(""),y=Re([]),$=[],U=[],z=Re([]),T=Re([{name:"Last Week",items:[{category:"Milk",img:"",priceRange:"",perUnitDisplay:"",unit:"l",quantity:2,manualOverrides:{rema:null,coop:null}},{category:"Beef",img:"",priceRange:"",perUnitDisplay:"",unit:"kg",quantity:.5,manualOverrides:{rema:null,coop:null}},{category:"Yogurt",img:"",priceRange:"",perUnitDisplay:"",unit:"kg",quantity:1,manualOverrides:{rema:null,coop:null}}]}]),J=Re(""),D=Re(null);st(async()=>{const n=await(await fetch("/scraper/export/combined_data_final_priced.csv")).text();U=pr.parse(n,{header:!0,skipEmptyLines:!0}).data;const b=new Set;for(const l of U)l["Best Category"]&&b.add(l["Best Category"].trim());m=Array.from(b).sort()});function q(){if(r(x).length<1){fe(y,[]);return}const h=r(x).toLowerCase();fe(y,m.filter(n=>n.toLowerCase().includes(h)&&!$.includes(n)).slice(0,10))}function N(h){$=[...$,h],fe(x,""),fe(y,[]);const n=U.filter(c=>{var b;return((b=c["Best Category"])==null?void 0:b.trim())===h});if(n.length>0){const c=n.map(F=>parseFloat(F.Price)).filter(F=>!isNaN(F)),b=Math.min(...c),l=Math.max(...c),P=b===l?`${b.toFixed(2)} DKK`:`${b.toFixed(2)}â€“${l.toFixed(2)} DKK`,p=n.find(F=>F.Img),E=["l","kg","other",""];let s="",k=[];for(const F of E)if(k=n.filter(K=>(K["Unit Standardized"]||"").trim().toLowerCase()===F).map(K=>parseFloat(K["Price per Unit"])).filter(K=>!isNaN(K)),k.length>0){s=F;break}let O="N/A";if(k.length>0){const F=Math.min(...k),K=Math.max(...k),C=s==="l"?"DKK/L":s==="kg"?"DKK/kg":"DKK/piece";O=F===K?`${F.toFixed(2)} ${C}`:`${F.toFixed(2)}â€“${K.toFixed(2)} ${C}`}fe(z,[...r(z),{category:h,img:(p==null?void 0:p.Img)||"",priceRange:P,perUnitDisplay:O,unit:s,quantity:1,manualOverrides:{rema:null,coop:null}}])}}function Ee(h){$=$.filter(n=>n!==h),fe(z,r(z).filter(n=>n.category!==h))}function oe(h,n,c,b){const P=[n,...["l","kg","other",""].filter(p=>p!==n)];for(const p of P){const s=U.filter(k=>{var O,F;return((O=k["Best Category"])==null?void 0:O.trim())===h&&((F=k.Retail)==null?void 0:F.trim())===b&&(k["Unit Standardized"]||"").trim().toLowerCase()===p}).map(k=>{const O=parseFloat(k["Quantity (Standardized)"]),F=parseFloat(k.Price),K=k.Name.charAt(0)+k.Name.toLowerCase().slice(1),C=k.Img,I=k["Quantity (Standardized)"];if(isNaN(O)||isNaN(F))return null;const o=c/O,w=Math.ceil(o),Y=w*F;return{name:K,unitSize:O,unitsToBuy:w,pricePerUnit:F,totalPrice:Y,img:C,packSize:I,unit:p}}).filter(Boolean);if(s.length>0)return s.reduce((k,O)=>k.totalPrice<O.totalPrice?k:O)}return null}function ue(h,n,c){const l=[n,...["l","kg","other",""].filter(P=>P!==n)];for(const P of l){const E=U.filter(s=>{var k,O;return((k=s["Best Category"])==null?void 0:k.trim())===h&&((O=s.Retail)==null?void 0:O.trim())===c&&(s["Unit Standardized"]||"").trim().toLowerCase()===P}).map(s=>{const k=parseFloat(s["Quantity (Standardized)"]),O=parseFloat(s.Price),F=s.Name,K=s.Img,C=s.Quantity;return isNaN(k)||isNaN(O)?null:{name:F,unit:P,unitQty:k,price:O,img:K,packSize:C}}).filter(Boolean);if(E.length>0)return E}return[]}async function he(h){fe(z,[]);for(const n of h){const c=U.filter(K=>{var C;return((C=K["Best Category"])==null?void 0:C.trim())===n.category});if(c.length===0)continue;const b=c.map(K=>parseFloat(K.Price)).filter(K=>!isNaN(K)),l=Math.min(...b),P=Math.max(...b),p=l===P?`${l.toFixed(2)} DKK`:`${l.toFixed(2)}â€“${P.toFixed(2)} DKK`,E=c.find(K=>K.Img),s=["l","kg","other",""];let k="",O=[];for(const K of s)if(O=c.filter(C=>(C["Unit Standardized"]||"").trim().toLowerCase()===K).map(C=>parseFloat(C["Price per Unit"])).filter(C=>!isNaN(C)),O.length>0){k=K;break}let F="N/A";if(O.length>0){const K=Math.min(...O),C=Math.max(...O),I=k==="l"?"DKK/L":k==="kg"?"DKK/kg":"DKK/piece";F=K===C?`${K.toFixed(2)} ${I}`:`${K.toFixed(2)}â€“${C.toFixed(2)} ${I}`}r(z).push({category:n.category,img:(E==null?void 0:E.Img)||"",priceRange:p,perUnitDisplay:F,unit:k,quantity:n.quantity,manualOverrides:{rema:null,coop:null}})}}Et(()=>r(z),()=>{fe(d,r(z).map((h,n)=>{const c=h.manualOverrides.rema,b=h.manualOverrides.coop,l=(P,p)=>{if(p){const E=Math.ceil(h.quantity/p.unitQty);return{name:p.name,unit:p.unit,pricePerUnit:p.price,unitsToBuy:E,totalPrice:E*p.price,img:p.img,packSize:p.packSize}}return oe(h.category,h.unit,h.quantity,P)};return{index:n,category:h.category,quantity:h.quantity,unit:h.unit,rema:l("Rema1000",c),coop:l("Coop",b)}}))}),St(),Ge();var le=Fr(),B=ze(le),Q=R(B);je(Q);var Se=A(Q,2);{var W=h=>{var n=_r();Ke(n,5,()=>r(y),Me,(c,b)=>{var l=vr(),P=R(l,!0);S(l),xe(()=>de(P,r(b))),Ae("click",l,()=>N(r(b))),ee(c,l)}),S(n),ee(h,n)};Te(Se,h=>{r(y).length>0&&h(W)})}S(B);var e=A(B,2);{var t=h=>{var n=Ir(),c=ze(n),b=A(R(c));Ke(b,5,()=>r(z),Me,(I,o,w)=>{var Y=yr(),re=R(Y),G=R(re);{var V=ge=>{var we=gr();xe(()=>qe(we,"src",r(o).img)),ee(ge,we)},H=ge=>{var we=mr();ee(ge,we)};Te(G,ge=>{r(o).img?ge(V):ge(H,!1)})}S(re);var me=A(re),M=R(me,!0);S(me);var Z=A(me),ne=R(Z,!0);S(Z);var pe=A(Z),ve=R(pe,!0);S(pe);var Oe=A(pe),se=R(Oe);je(se);var ye=A(se,2),X=R(ye,!0);S(ye),S(Oe);var ce=A(Oe),_e=R(ce);S(ce),S(Y),xe(()=>{de(M,r(o).category),de(ne,r(o).priceRange),de(ve,r(o).perUnitDisplay),de(X,r(o).unit==="l"?"liters":r(o).unit==="kg"?"kg":"pcs")}),He(se,()=>r(o).quantity,ge=>(r(o).quantity=ge,dt(()=>r(z)))),Ae("click",_e,()=>Ee(r(o).category)),ee(I,Y)}),S(b),S(c);var l=A(c,2),P=A(R(l)),p=R(P);Ke(p,1,()=>r(d),Me,(I,o)=>{var w=Lr(),Y=R(w),re=R(Y,!0);S(Y);var G=A(Y);{var V=ne=>{var pe=Er(),ve=ze(pe),Oe=R(ve);{var se=ae=>{var ie=br();xe(()=>qe(ie,"src",r(o).rema.img)),ee(ae,ie)},ye=ae=>{var ie=kr();ee(ae,ie)};Te(Oe,ae=>{r(o).rema.img?ae(se):ae(ye,!1)})}S(ve);var X=A(ve,2),ce=R(X);S(X);var _e=A(X,2),ge=R(_e),we=A(ge),Ie=R(we);S(we),S(_e);var ke=A(_e,2),De=R(ke),Ce=R(De);Ce.value=(Ce.__value=null)==null?"":null;var Ve=R(Ce);S(Ce);var Ze=A(Ce);Ke(Ze,1,()=>ue(r(o).category,r(o).unit,"Rema1000"),Me,(ae,ie)=>{var be=xr(),Le={},$e=R(be);S(be),xe(Ne=>{Le!==(Le=Ne)&&(be.value=(be.__value=Ne)==null?"":Ne),de($e,`${r(ie).name??""} â€“ ${r(ie).packSize??""}${r(ie).unit??""} (${r(ie).price??""} DKK)`)},[()=>JSON.stringify(r(ie))],Ue),ee(ae,be)}),S(De),S(ke),xe((ae,ie)=>{var be,Le,$e;de(ce,`${r(o).rema.name??""}, ${r(o).rema.packSize??""}${r(o).rema.unit??""}`),de(ge,`${ae??""} DKK Ã— ${r(o).rema.unitsToBuy??""} = `),de(Ie,`${ie??""} DKK`),de(Ve,`Auto: ${((be=r(o).rema)==null?void 0:be.name)??""} (${((Le=r(o).rema)==null?void 0:Le.packSize)??""}${(($e=r(o).rema)==null?void 0:$e.unit)??""})`)},[()=>r(o).rema.pricePerUnit.toFixed(2),()=>r(o).rema.totalPrice.toFixed(2)],Ue),Ae("change",De,ae=>ft(z,r(z)[r(o).index].manualOverrides.rema=JSON.parse(ae.target.value))),ee(ne,pe)},H=ne=>{var pe=Sr();ee(ne,pe)};Te(G,ne=>{r(o).rema?ne(V):ne(H,!1)})}var me=A(G);{var M=ne=>{var pe=wr(),ve=ze(pe),Oe=R(ve);{var se=ae=>{var ie=Cr();xe(()=>qe(ie,"src",r(o).coop.img)),ee(ae,ie)},ye=ae=>{var ie=Rr();ee(ae,ie)};Te(Oe,ae=>{r(o).coop.img?ae(se):ae(ye,!1)})}S(ve);var X=A(ve,2),ce=R(X);S(X);var _e=A(X,2),ge=R(_e),we=A(ge),Ie=R(we);S(we),S(_e);var ke=A(_e,2),De=R(ke),Ce=R(De);Ce.value=(Ce.__value=null)==null?"":null;var Ve=R(Ce);S(Ce);var Ze=A(Ce);Ke(Ze,1,()=>ue(r(o).category,r(o).unit,"Coop"),Me,(ae,ie)=>{var be=Or(),Le={},$e=R(be);S(be),xe(Ne=>{Le!==(Le=Ne)&&(be.value=(be.__value=Ne)==null?"":Ne),de($e,`${r(ie).name??""} â€“ ${r(ie).packSize??""}${r(ie).unit??""} (${r(ie).price??""} DKK)`)},[()=>JSON.stringify(r(ie))],Ue),ee(ae,be)}),S(De),S(ke),xe((ae,ie)=>{var be,Le,$e;de(ce,`${r(o).coop.name??""}, ${r(o).coop.packSize??""}${r(o).coop.unit??""}`),de(ge,`${ae??""} DKK Ã— ${r(o).coop.unitsToBuy??""} = `),de(Ie,`${ie??""} DKK`),de(Ve,`Auto: ${((be=r(o).coop)==null?void 0:be.name)??""} (${((Le=r(o).coop)==null?void 0:Le.packSize)??""}${(($e=r(o).coop)==null?void 0:$e.unit)??""})`)},[()=>r(o).coop.pricePerUnit.toFixed(2),()=>r(o).coop.totalPrice.toFixed(2)],Ue),Ae("change",De,ae=>ft(z,r(z)[r(o).index].manualOverrides.coop=JSON.parse(ae.target.value))),ee(ne,pe)},Z=ne=>{var pe=Dr();ee(ne,pe)};Te(me,ne=>{r(o).coop?ne(M):ne(Z,!1)})}S(w),xe(()=>de(re,r(o).category)),ee(I,w)});var E=A(p),s=A(R(E),2),k=R(s),O=R(k);S(k),S(s);var F=A(s,2),K=R(F),C=R(K);S(K),S(F),S(E),S(P),S(l),xe((I,o)=>{de(O,`${I??""} DKK`),de(C,`${o??""} DKK`)},[()=>r(d).map(I=>{var o;return((o=I.rema)==null?void 0:o.totalPrice)||0}).reduce((I,o)=>I+o,0).toFixed(2),()=>r(d).map(I=>{var o;return((o=I.coop)==null?void 0:o.totalPrice)||0}).reduce((I,o)=>I+o,0).toFixed(2)],Ue),ee(h,n)};Te(e,h=>{r(z).length>0&&h(t)})}var a=A(e,6),f=R(a);je(f);var g=A(f,2);S(a);var v=A(a,2);{var j=h=>{var n=Ar(),c=R(n);xe(()=>{r(D),dt(()=>{r(T)})});var b=R(c);b.value=(b.__value=null)==null?"":null;var l=A(b);Ke(l,1,()=>r(T),Me,(E,s,k)=>{var O=Tr();O.value=(O.__value=k)==null?"":k;var F=R(O,!0);S(O),xe(()=>de(F,r(s).name)),ee(E,O)}),S(c);var P=A(c,2),p=A(P,2);S(n),rr(c,()=>r(D),E=>fe(D,E)),Ae("click",P,()=>{r(D)!==null&&he(r(T)[r(D)].items)}),Ae("click",p,()=>{r(D)!==null&&(r(T).splice(r(D),1),fe(D,null))}),ee(h,n)};Te(v,h=>{r(T).length>0&&h(j)})}He(Q,()=>r(x),h=>fe(x,h)),Ae("input",Q,q),He(f,()=>r(J),h=>fe(J,h)),Ae("click",g,()=>{!r(J)||r(z).length===0||(fe(T,[...r(T),{name:r(J),items:JSON.parse(JSON.stringify(r(z)))}]),fe(J,""))}),ee(i,le),Ye()}var Pr=te(`<div class="savings-progress svelte-13kv8p7"><div class="savings-label svelte-13kv8p7">You've saved <strong></strong> this month out of your <strong></strong> goal!</div> <div class="progress-bar svelte-13kv8p7"><div class="progress-bar__fill svelte-13kv8p7"></div></div> <div class="progress-label svelte-13kv8p7"> </div></div>`);function Nr(i,u){Je(u,!1);const d=Re();let m=200,x=110;Et(()=>{},()=>{fe(d,Math.min(x/m*100,100).toFixed(0))}),St(),Ge();var y=Pr(),$=R(y),U=A(R($));U.textContent=`${x} DKK`;var z=A(U,2);z.textContent=`${m} DKK`,xt(),S($);var _=A($,2),T=R(_);S(_);var J=A(_,2),D=R(J);S(J),S(y),xe(()=>{er(T,`width: ${r(d)??""}%`),de(D,`${r(d)??""}%`)}),ee(i,y),Ye()}var Mr=te('<div class="header"><h1 class="svelte-14u9xq7"></h1> <h2 class="svelte-14u9xq7">Here is the overview of Your Shopping:</h2> <!></div> <div class="col-2"><div class="col-2-left"><h2 class="svelte-14u9xq7">Shopping List</h2> <!></div></div> <div class="col-1"><h2 class="svelte-14u9xq7">Nearby Stores</h2> <!></div>',1);function Gr(i,u){Je(u,!1);let d="Daniel";st(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(q=>{q.coords.latitude,q.coords.longitude})});function m({start:q,end:N}){}Ge();var x=Mr(),y=ze(x),$=R(y);$.textContent=`Hi ${d},`;var U=A($,4);Nr(U,{}),S(y);var z=A(y,2),_=R(z),T=A(R(_),2);$r(T,{}),S(_),S(z);var J=A(z,2),D=A(R(J),2);ur(D,{onRouteCreated:m}),S(J),ee(i,x),Ye()}export{Gr as _,Yr as c,cr as g};
