import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{s as Xe,l as Le,h as wt,o as Dt,n as Lt,z as It,g as a,K as qe,A as At,B as ot,C as et,m as Be,a8 as Tt,D as gt,F as mt,G as Nt,ac as yt,a4 as Ft,W as Re,al as lt,am as tt,k as ut,an as it,ao as ct,ap as Mt,ab as Pt,aq as $t,ar as Kt,as as nt,at as Ut,a2 as qt,a6 as zt,au as bt,av as Bt,aw as jt,ax as Ht,ay as Wt,az as Qt,aA as Yt,aB as Jt,b as Gt,af as Vt,ae as kt,aC as Zt,p as Ye,q as ze,v as Je,w as T,x as R,V as fe,ai as Xt,y as S,ak as xt,t as xe,aD as Et,aE as St,aF as dt,aG as ft}from"./CVVSsr9f.js";import{t as te,a as ee}from"./DbpCYL1g.js";import{i as Ge}from"./BFipLYMe.js";import{o as st}from"./2YWAzhhZ.js";import{p as er,i as Te,_ as ht}from"./CE8ryfk0.js";import{a as tr,l as Ct,e as Ne,s as de}from"./BRKOJx6a.js";function Ke(r,n){return n}function rr(r,n,o,f){for(var y=[],b=n.length,F=0;F<b;F++)Mt(n[F].e,y,!0);var U=b>0&&y.length===0&&o!==null;if(U){var q=o.parentNode;Pt(q),q.append(o),f.clear(),Me(r,n[0].prev,n[b-1].next)}$t(y,()=>{for(var g=0;g<b;g++){var A=n[g];U||(f.delete(A.k),Me(r,A.prev,A.next)),Kt(A.e,!U)}})}function Ue(r,n,o,f,y,b=null){var F=r,U={flags:n,items:new Map,first:null},q=(n&bt)!==0;if(q){var g=r;F=Le?Xe(wt(g)):g.appendChild(Dt())}Le&&Lt();var A=null,Y=!1,D=qe(()=>{var z=o();return Ft(z)?z:z==null?[]:yt(z)});It(()=>{var z=a(D),P=z.length;if(Y&&P===0)return;Y=P===0;let Ee=!1;if(Le){var oe=F.data===At;oe!==(P===0)&&(F=ot(),Xe(F),et(!1),Ee=!0)}if(Le){for(var ue=null,he,le=0;le<P;le++){if(Be.nodeType===8&&Be.data===Tt){F=Be,Ee=!0,et(!1);break}var B=z[le],W=f(B,le);he=Rt(Be,U,ue,null,B,W,le,y,n,o),U.items.set(W,he),ue=he}P>0&&Xe(ot())}Le||ar(z,U,F,y,n,f,o),b!==null&&(P===0?A?gt(A):A=mt(()=>b(F)):A!==null&&Nt(A,()=>{A=null})),Ee&&et(!0),a(D)}),Le&&(F=Be)}function ar(r,n,o,f,y,b,F){var j,p,s,d;var U=(y&Bt)!==0,q=(y&(nt|it))!==0,g=r.length,A=n.items,Y=n.first,D=Y,z,P=null,Ee,oe=[],ue=[],he,le,B,W;if(U)for(W=0;W<g;W+=1)he=r[W],le=b(he,W),B=A.get(le),B!==void 0&&((j=B.a)==null||j.measure(),(Ee??(Ee=new Set)).add(B));for(W=0;W<g;W+=1){if(he=r[W],le=b(he,W),B=A.get(le),B===void 0){var Se=D?D.e.nodes_start:o;P=Rt(Se,n,P,P===null?n.first:P.next,he,le,W,f,y,F),A.set(le,P),oe=[],ue=[],D=P.next;continue}if(q&&ir(B,he,W,y),(B.e.f&tt)!==0&&(gt(B.e),U&&((p=B.a)==null||p.unfix(),(Ee??(Ee=new Set)).delete(B))),B!==D){if(z!==void 0&&z.has(B)){if(oe.length<ue.length){var Q=ue[0],e;P=Q.prev;var t=oe[0],i=oe[oe.length-1];for(e=0;e<oe.length;e+=1)pt(oe[e],Q,o);for(e=0;e<ue.length;e+=1)z.delete(ue[e]);Me(n,t.prev,i.next),Me(n,P,t),Me(n,i,Q),D=Q,P=i,W-=1,oe=[],ue=[]}else z.delete(B),pt(B,D,o),Me(n,B.prev,B.next),Me(n,B,P===null?n.first:P.next),Me(n,P,B),P=B;continue}for(oe=[],ue=[];D!==null&&D.k!==le;)(D.e.f&tt)===0&&(z??(z=new Set)).add(D),ue.push(D),D=D.next;if(D===null)continue;B=D}oe.push(B),P=B,D=B.next}if(D!==null||z!==void 0){for(var h=z===void 0?[]:yt(z);D!==null;)(D.e.f&tt)===0&&h.push(D),D=D.next;var m=h.length;if(m>0){var _=(y&bt)!==0&&g===0?o:null;if(U){for(W=0;W<m;W+=1)(s=h[W].a)==null||s.measure();for(W=0;W<m;W+=1)(d=h[W].a)==null||d.fix()}rr(n,h,_,A)}}U&&qt(()=>{var k;if(Ee!==void 0)for(B of Ee)(k=B.a)==null||k.apply()}),ut.first=n.first&&n.first.e,ut.last=P&&P.e}function ir(r,n,o,f){(f&nt)!==0&&ct(r.v,n),(f&it)!==0?ct(r.i,o):r.i=o}function Rt(r,n,o,f,y,b,F,U,q,g){var A=(q&nt)!==0,Y=(q&Ut)===0,D=A?Y?Re(y):lt(y):y,z=(q&it)===0?F:lt(F),P={i:z,v:D,k:b,a:null,e:null,prev:o,next:f};try{return P.e=mt(()=>U(r,D,z,g),Le),P.e.prev=o&&o.e,P.e.next=f&&f.e,o===null?n.first=P:(o.next=P,o.e.next=P.e),f!==null&&(f.prev=P,f.e.prev=P.e),P}finally{}}function pt(r,n,o){for(var f=r.next?r.next.e.nodes_start:o,y=n?n.e.nodes_start:o,b=r.e.nodes_start;b!==f;){var F=zt(b);y.before(b),b=F}}function Me(r,n,o){n===null?r.first=o:(n.next=o,n.e.next=o&&o.e),o!==null&&(o.prev=n,o.e.prev=n&&n.e)}function nr(r,n){return r==null?null:String(r)}function sr(r,n,o,f){var y=r.__style;if(Le||y!==n){var b=nr(n);(!Le||b!==r.getAttribute("style"))&&(b==null?r.removeAttribute("style"):r.style.cssText=b),r.__style=n}return f}const or=Symbol("is custom element"),lr=Symbol("is html");function je(r){if(Le){var n=!1,o=()=>{if(!n){if(n=!0,r.hasAttribute("value")){var f=r.value;Pe(r,"value",null),r.value=f}if(r.hasAttribute("checked")){var y=r.checked;Pe(r,"checked",null),r.checked=y}}};r.__on_r=o,jt(o),tr()}}function Pe(r,n,o,f){var y=ur(r);Le&&(y[n]=r.getAttribute(n),n==="src"||n==="srcset"||n==="href"&&r.nodeName==="LINK")||y[n]!==(y[n]=o)&&(n==="loading"&&(r[Ht]=o),o==null?r.removeAttribute(n):typeof o!="string"&&cr(r).includes(n)?r[n]=o:r.setAttribute(n,o))}function ur(r){return r.__attributes??(r.__attributes={[or]:r.nodeName.includes("-"),[lr]:r.namespaceURI===Wt})}var vt=new Map;function cr(r){var n=vt.get(r.nodeName);if(n)return n;vt.set(r.nodeName,n=[]);for(var o,f=r,y=Element.prototype;y!==f;){o=Yt(f);for(var b in o)o[b].set&&n.push(b);f=Qt(f)}return n}function He(r,n,o=n){var f=Jt();Ct(r,"input",y=>{var b=y?r.defaultValue:r.value;if(b=rt(r)?at(b):b,o(b),f&&b!==(b=n())){var F=r.selectionStart,U=r.selectionEnd;r.value=b??"",U!==null&&(r.selectionStart=F,r.selectionEnd=Math.min(U,r.value.length))}}),(Le&&r.defaultValue!==r.value||Gt(n)==null&&r.value)&&o(rt(r)?at(r.value):r.value),Vt(()=>{var y=n();rt(r)&&y===at(r.value)||r.type==="date"&&!y&&!r.value||y!==r.value&&(r.value=y??"")})}function rt(r){var n=r.type;return n==="number"||n==="range"}function at(r){return r===""?null:+r}function Ot(r,n,o){if(r.multiple)return hr(r,n);for(var f of r.options){var y=We(f);if(Zt(y,n)){f.selected=!0;return}}(!o||n!==void 0)&&(r.selectedIndex=-1)}function dr(r,n){kt(()=>{var o=new MutationObserver(()=>{var f=r.__value;Ot(r,f)});return o.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{o.disconnect()}})}function fr(r,n,o=n){var f=!0;Ct(r,"change",y=>{var b=y?"[selected]":":checked",F;if(r.multiple)F=[].map.call(r.querySelectorAll(b),We);else{var U=r.querySelector(b)??r.querySelector("option:not([disabled])");F=U&&We(U)}o(F)}),kt(()=>{var y=n();if(Ot(r,y,f),f&&y===void 0){var b=r.querySelector(":checked");b!==null&&(y=We(b),o(y))}r.__value=y,f=!1}),dr(r)}function hr(r,n){for(var o of r.options)o.selected=~n.indexOf(We(o))}function We(r){return"__value"in r?r.__value:r.value}function pr(r){return function(...n){var o=n[0];return o.preventDefault(),r==null?void 0:r.apply(this,n)}}var vr=te('<div class="controller__stop svelte-1or32pp"><img alt="Stop Icon" width="24" height="24"> <span class="svelte-1or32pp"> </span> <button type="button" class="controller__remove svelte-1or32pp" aria-label="Remove stop">✕</button></div>'),_r=te('<div class="controller__stops svelte-1or32pp"></div>'),gr=te('<div class="opener svelte-1or32pp"><a class="opener__link svelte-1or32pp" target="_blank" rel="noopener noreferrer"><button class="opener__button svelte-1or32pp">Open in Google Maps</button></a> <a class="opener__link svelte-1or32pp" target="_blank" rel="noopener noreferrer"><button class="opener__button svelte-1or32pp">Open in Apple Maps</button></a></div>'),mr=te('<form class="controller svelte-1or32pp"><div class="controller__section svelte-1or32pp"><label class="controller__label svelte-1or32pp">Start:</label> <input class="controller__input svelte-1or32pp" type="text" placeholder="Your location or address"></div> <!> <div class="controller__section svelte-1or32pp"><label class="controller__label svelte-1or32pp">End:</label> <input class="controller__input svelte-1or32pp" type="text" placeholder="Type address or store name"></div> <button class="controller__submit svelte-1or32pp" type="submit">Go!</button></form> <div id="map" class="map svelte-1or32pp"></div> <!>',1);function yr(r,n){Ye(n,!1);let o,f,y=[],b=null,F=Re(""),U=Re(""),q=Re("📍 Your Location"),g=Re(""),A=null,Y=null,D=null,z=Re([]);const P={Discount365:"Coop_Marker","Rema 1000":"Rema_Marker"};let Ee=er(n,"onRouteCreated",8,()=>{});async function oe(_){const p=await(await fetch(`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(_)}&format=json&limit=1`)).json();return p.length===0?null:{lat:parseFloat(p[0].lat),lng:parseFloat(p[0].lon)}}function ue(_){if(!_)return"Unknown";const j=_.toLowerCase();return j.includes("discount")?"Discount365":j.includes("rema")?"Rema 1000":"Other"}async function he(){if(!o)return;if(a(q)==="📍 Your Location"){if(!b)return;A=L.latLng(b.lat,b.lng)}else{const s=await oe(a(q));if(!s)return;A=L.latLng(s.lat,s.lng)}if(!a(g))return;const _=await oe(a(g));if(!_)return;Y=L.latLng(_.lat,_.lng),f&&o.removeControl(f);const j=[A,...a(z).map(s=>s.coord)];Y&&j.push(Y),f=L.Routing.control({waypoints:j,routeWhileDragging:!0}).addTo(o),fe(F,"https://www.google.com/maps/dir/"+[A,...a(z).map(s=>s.coord),Y].filter(Boolean).map(s=>`${s.lat},${s.lng}`).join("/")),fe(U,`https://maps.apple.com/?saddr=${A.lat},${A.lng}&daddr=${Y.lat},${Y.lng}`);let p=[A,...a(z).map(s=>s.coord),Y].filter(Boolean);p.length>=2&&fe(U,`https://maps.apple.com/?saddr=${p[0].lat},${p[0].lng}&daddr=${p.slice(1).map(s=>`${s.lat},${s.lng}`).join("+to:")}`),Ee()({start:A,end:Y})}st(async()=>{const _=await ht(()=>import("./8iLVXnth.js").then(s=>s.l),[],import.meta.url);window.L=_,await ht(()=>import("./CAND9Xuk.js").then(s=>s.l),[],import.meta.url),o=_.map("map").setView([55.6761,12.5683],13),_.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(o),o.locate({setView:!0,maxZoom:14}),o.on("locationfound",s=>{b=s.latlng,console.log("User location found:",b),D?D.setLatLng(b):D=_.circleMarker(b,{radius:8,color:"#1976d2",fillColor:"#2196f3",fillOpacity:.8,weight:2}).addTo(o).bindTooltip("You are here",{permanent:!1,direction:"top"}),he()}),y=(await(await fetch("/data/stores.json")).json()).features.filter(s=>{var d;return((d=s.geometry)==null?void 0:d.type)==="Point"}).map(s=>{var l,x;const[d,k]=s.geometry.coordinates,c=((l=s.properties)==null?void 0:l.name)||"Unknown",M=((x=s.properties)==null?void 0:x.branch)||"",v=ue(c);return{name:M?`${v} ${M}`:c,lat:k,lng:d,chain:v}}).filter(s=>s.chain==="Discount365"||s.chain==="Rema 1000"),y.forEach(s=>{const d=_.divIcon({className:"icon",html:`
				<img
					class="icon__image"
					src="/images/${P[s.chain]}.png"
					height=48 width=48
					style="
						position:absolute;
						bottom: 0;
						left: 50%;
						transform: translateX(-50%);
					"
				>`}),k=_.marker([s.lat,s.lng],{icon:d}).addTo(o);k.on("click",()=>{const c=_.latLng(s.lat,s.lng);fe(z,[...a(z),{name:s.name,coord:c}]),he()}),k.bindTooltip(`Set Waypoint: ${s.name}`,{permanent:!1,direction:"top"})}),await Xt(),he()}),Ge();var le=mr(),B=ze(le),W=R(B),Se=T(R(W),2);je(Se),S(W);var Q=T(W,2);{var e=_=>{var j=_r();Ue(j,5,()=>a(z),Ke,(p,s,d)=>{var k=vr(),c=R(k),M=T(c,2),v=R(M,!0);S(M);var E=T(M,2);S(k),xe(l=>{Pe(c,"src",l),de(v,a(s).name)},[()=>`/images/${P[ue(a(s).name)]}.png`],qe),Ne("click",E,()=>{a(z).splice(d,1),he()}),ee(p,k)}),S(j),ee(_,j)};Te(Q,_=>{a(z).length>0&&_(e)})}var t=T(Q,2),i=T(R(t),2);je(i),S(t),xt(2),S(B);var h=T(B,4);{var m=_=>{var j=gr(),p=R(j),s=T(p,2);S(j),xe(()=>{Pe(p,"href",a(F)),Pe(s,"href",a(U))}),ee(_,j)};Te(h,_=>{a(F)&&a(U)&&_(m)})}He(Se,()=>a(q),_=>fe(q,_)),He(i,()=>a(g),_=>fe(g,_)),Ne("submit",B,pr(he)),ee(r,le),Je()}var aa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function br(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Qe={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var kr=Qe.exports,_t;function xr(){return _t||(_t=1,function(r,n){((o,f)=>{r.exports=f()})(kr,function o(){var f=typeof self<"u"?self:typeof window<"u"?window:f!==void 0?f:{},y,b=!f.document&&!!f.postMessage,F=f.IS_PAPA_WORKER||!1,U={},q=0,g={};function A(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(t){var i=W(t);i.chunkSize=parseInt(i.chunkSize),t.step||t.chunk||(i.chunkSize=null),this._handle=new Ee(i),(this._handle.streamer=this)._config=i}).call(this,e),this.parseChunk=function(t,i){var h=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<h){let _=this._config.newline;_||(m=this._config.quoteChar||'"',_=this._handle.guessLineEndings(t,m)),t=[...t.split(_).slice(h)].join(_)}this.isFirstChunk&&Q(this._config.beforeFirstChunk)&&(m=this._config.beforeFirstChunk(t))!==void 0&&(t=m),this.isFirstChunk=!1,this._halted=!1;var h=this._partialLine+t,m=(this._partialLine="",this._handle.parse(h,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(t=m.meta.cursor,h=(this._finished||(this._partialLine=h.substring(t-this._baseIndex),this._baseIndex=t),m&&m.data&&(this._rowCount+=m.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),F)f.postMessage({results:m,workerId:g.WORKER_ID,finished:h});else if(Q(this._config.chunk)&&!i){if(this._config.chunk(m,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=m=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(m.data),this._completeResults.errors=this._completeResults.errors.concat(m.errors),this._completeResults.meta=m.meta),this._completed||!h||!Q(this._config.complete)||m&&m.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),h||m&&m.meta.paused||this._nextChunk(),m}this._halted=!0},this._sendError=function(t){Q(this._config.error)?this._config.error(t):F&&this._config.error&&f.postMessage({workerId:g.WORKER_ID,error:t,finished:!1})}}function Y(e){var t;(e=e||{}).chunkSize||(e.chunkSize=g.RemoteChunkSize),A.call(this,e),this._nextChunk=b?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(i){this._input=i,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),b||(t.onload=Se(this._chunkLoaded,this),t.onerror=Se(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!b),this._config.downloadRequestHeaders){var i,h=this._config.downloadRequestHeaders;for(i in h)t.setRequestHeader(i,h[i])}var m;this._config.chunkSize&&(m=this._start+this._config.chunkSize-1,t.setRequestHeader("Range","bytes="+this._start+"-"+m));try{t.send(this._config.downloadRequestBody)}catch(_){this._chunkError(_.message)}b&&t.status===0&&this._chunkError()}},this._chunkLoaded=function(){t.readyState===4&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize||t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(i=>(i=i.getResponseHeader("Content-Range"))!==null?parseInt(i.substring(i.lastIndexOf("/")+1)):-1)(t),this.parseChunk(t.responseText)))},this._chunkError=function(i){i=t.statusText||i,this._sendError(new Error(i))}}function D(e){(e=e||{}).chunkSize||(e.chunkSize=g.LocalChunkSize),A.call(this,e);var t,i,h=typeof FileReader<"u";this.stream=function(m){this._input=m,i=m.slice||m.webkitSlice||m.mozSlice,h?((t=new FileReader).onload=Se(this._chunkLoaded,this),t.onerror=Se(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var m=this._input,_=(this._config.chunkSize&&(_=Math.min(this._start+this._config.chunkSize,this._input.size),m=i.call(m,this._start,_)),t.readAsText(m,this._config.encoding));h||this._chunkLoaded({target:{result:_}})},this._chunkLoaded=function(m){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(m.target.result)},this._chunkError=function(){this._sendError(t.error)}}function z(e){var t;A.call(this,e=e||{}),this.stream=function(i){return t=i,this._nextChunk()},this._nextChunk=function(){var i,h;if(!this._finished)return i=this._config.chunkSize,t=i?(h=t.substring(0,i),t.substring(i)):(h=t,""),this._finished=!t,this.parseChunk(h)}}function P(e){A.call(this,e=e||{});var t=[],i=!0,h=!1;this.pause=function(){A.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){A.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(m){this._input=m,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){h&&t.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=Se(function(m){try{t.push(typeof m=="string"?m:m.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(_){this._streamError(_)}},this),this._streamError=Se(function(m){this._streamCleanUp(),this._sendError(m)},this),this._streamEnd=Se(function(){this._streamCleanUp(),h=!0,this._streamData("")},this),this._streamCleanUp=Se(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function Ee(e){var t,i,h,m,_=Math.pow(2,53),j=-_,p=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,s=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,d=this,k=0,c=0,M=!1,v=!1,E=[],l={data:[],errors:[],meta:{}};function x(C){return e.skipEmptyLines==="greedy"?C.join("").trim()==="":C.length===1&&C[0].length===0}function O(){if(l&&h&&(K("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+g.DefaultDelimiter+"'"),h=!1),e.skipEmptyLines&&(l.data=l.data.filter(function(w){return!x(w)})),N()){let w=function(J,re){Q(e.transformHeader)&&(J=e.transformHeader(J,re)),E.push(J)};if(l)if(Array.isArray(l.data[0])){for(var C=0;N()&&C<l.data.length;C++)l.data[C].forEach(w);l.data.splice(0,1)}else l.data.forEach(w)}function I(w,J){for(var re=e.header?{}:[],G=0;G<w.length;G++){var V=G,H=w[G],H=((me,$)=>(Z=>(e.dynamicTypingFunction&&e.dynamicTyping[Z]===void 0&&(e.dynamicTyping[Z]=e.dynamicTypingFunction(Z)),(e.dynamicTyping[Z]||e.dynamicTyping)===!0))(me)?$==="true"||$==="TRUE"||$!=="false"&&$!=="FALSE"&&((Z=>{if(p.test(Z)&&(Z=parseFloat(Z),j<Z&&Z<_))return 1})($)?parseFloat($):s.test($)?new Date($):$===""?null:$):$)(V=e.header?G>=E.length?"__parsed_extra":E[G]:V,H=e.transform?e.transform(H,V):H);V==="__parsed_extra"?(re[V]=re[V]||[],re[V].push(H)):re[V]=H}return e.header&&(G>E.length?K("FieldMismatch","TooManyFields","Too many fields: expected "+E.length+" fields but parsed "+G,c+J):G<E.length&&K("FieldMismatch","TooFewFields","Too few fields: expected "+E.length+" fields but parsed "+G,c+J)),re}var u;l&&(e.header||e.dynamicTyping||e.transform)&&(u=1,!l.data.length||Array.isArray(l.data[0])?(l.data=l.data.map(I),u=l.data.length):l.data=I(l.data,0),e.header&&l.meta&&(l.meta.fields=E),c+=u)}function N(){return e.header&&E.length===0}function K(C,I,u,w){C={type:C,code:I,message:u},w!==void 0&&(C.row=w),l.errors.push(C)}Q(e.step)&&(m=e.step,e.step=function(C){l=C,N()?O():(O(),l.data.length!==0&&(k+=C.data.length,e.preview&&k>e.preview?i.abort():(l.data=l.data[0],m(l,d))))}),this.parse=function(C,I,u){var w=e.quoteChar||'"',w=(e.newline||(e.newline=this.guessLineEndings(C,w)),h=!1,e.delimiter?Q(e.delimiter)&&(e.delimiter=e.delimiter(C),l.meta.delimiter=e.delimiter):((w=((J,re,G,V,H)=>{var me,$,Z,ne;H=H||[",","	","|",";",g.RECORD_SEP,g.UNIT_SEP];for(var pe=0;pe<H.length;pe++){for(var ve,Oe=H[pe],se=0,ye=0,X=0,ce=(Z=void 0,new ue({comments:V,delimiter:Oe,newline:re,preview:10}).parse(J)),_e=0;_e<ce.data.length;_e++)G&&x(ce.data[_e])?X++:(ve=ce.data[_e].length,ye+=ve,Z===void 0?Z=ve:0<ve&&(se+=Math.abs(ve-Z),Z=ve));0<ce.data.length&&(ye/=ce.data.length-X),($===void 0||se<=$)&&(ne===void 0||ne<ye)&&1.99<ye&&($=se,me=Oe,ne=ye)}return{successful:!!(e.delimiter=me),bestDelimiter:me}})(C,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess)).successful?e.delimiter=w.bestDelimiter:(h=!0,e.delimiter=g.DefaultDelimiter),l.meta.delimiter=e.delimiter),W(e));return e.preview&&e.header&&w.preview++,t=C,i=new ue(w),l=i.parse(t,I,u),O(),M?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return M},this.pause=function(){M=!0,i.abort(),t=Q(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){d.streamer._halted?(M=!1,d.streamer.parseChunk(t,!0)):setTimeout(d.resume,3)},this.aborted=function(){return v},this.abort=function(){v=!0,i.abort(),l.meta.aborted=!0,Q(e.complete)&&e.complete(l),t=""},this.guessLineEndings=function(J,w){J=J.substring(0,1048576);var w=new RegExp(oe(w)+"([^]*?)"+oe(w),"gm"),u=(J=J.replace(w,"")).split("\r"),w=J.split(`
`),J=1<w.length&&w[0].length<u[0].length;if(u.length===1||J)return`
`;for(var re=0,G=0;G<u.length;G++)u[G][0]===`
`&&re++;return re>=u.length/2?`\r
`:"\r"}}function oe(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ue(e){var t=(e=e||{}).delimiter,i=e.newline,h=e.comments,m=e.step,_=e.preview,j=e.fastMode,p=null,s=!1,d=e.quoteChar==null?'"':e.quoteChar,k=d;if(e.escapeChar!==void 0&&(k=e.escapeChar),(typeof t!="string"||-1<g.BAD_DELIMITERS.indexOf(t))&&(t=","),h===t)throw new Error("Comment character same as delimiter");h===!0?h="#":(typeof h!="string"||-1<g.BAD_DELIMITERS.indexOf(h))&&(h=!1),i!==`
`&&i!=="\r"&&i!==`\r
`&&(i=`
`);var c=0,M=!1;this.parse=function(v,E,l){if(typeof v!="string")throw new Error("Input must be a string");var x=v.length,O=t.length,N=i.length,K=h.length,C=Q(m),I=[],u=[],w=[],J=c=0;if(!v)return se();if(j||j!==!1&&v.indexOf(d)===-1){for(var re=v.split(i),G=0;G<re.length;G++){if(w=re[G],c+=w.length,G!==re.length-1)c+=i.length;else if(l)return se();if(!h||w.substring(0,K)!==h){if(C){if(I=[],ne(w.split(t)),ye(),M)return se()}else ne(w.split(t));if(_&&_<=G)return I=I.slice(0,_),se(!0)}}return se()}for(var V=v.indexOf(t,c),H=v.indexOf(i,c),me=new RegExp(oe(k)+oe(d),"g"),$=v.indexOf(d,c);;)if(v[c]===d)for($=c,c++;;){if(($=v.indexOf(d,$+1))===-1)return l||u.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:I.length,index:c}),ve();if($===x-1)return ve(v.substring(c,$).replace(me,d));if(d===k&&v[$+1]===k)$++;else if(d===k||$===0||v[$-1]!==k){V!==-1&&V<$+1&&(V=v.indexOf(t,$+1));var Z=pe((H=H!==-1&&H<$+1?v.indexOf(i,$+1):H)===-1?V:Math.min(V,H));if(v.substr($+1+Z,O)===t){w.push(v.substring(c,$).replace(me,d)),v[c=$+1+Z+O]!==d&&($=v.indexOf(d,c)),V=v.indexOf(t,c),H=v.indexOf(i,c);break}if(Z=pe(H),v.substring($+1+Z,$+1+Z+N)===i){if(w.push(v.substring(c,$).replace(me,d)),Oe($+1+Z+N),V=v.indexOf(t,c),$=v.indexOf(d,c),C&&(ye(),M))return se();if(_&&I.length>=_)return se(!0);break}u.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:I.length,index:c}),$++}}else if(h&&w.length===0&&v.substring(c,c+K)===h){if(H===-1)return se();c=H+N,H=v.indexOf(i,c),V=v.indexOf(t,c)}else if(V!==-1&&(V<H||H===-1))w.push(v.substring(c,V)),c=V+O,V=v.indexOf(t,c);else{if(H===-1)break;if(w.push(v.substring(c,H)),Oe(H+N),C&&(ye(),M))return se();if(_&&I.length>=_)return se(!0)}return ve();function ne(X){I.push(X),J=c}function pe(X){var ce=0;return ce=X!==-1&&(X=v.substring($+1,X))&&X.trim()===""?X.length:ce}function ve(X){return l||(X===void 0&&(X=v.substring(c)),w.push(X),c=x,ne(w),C&&ye()),se()}function Oe(X){c=X,ne(w),w=[],H=v.indexOf(i,c)}function se(X){if(e.header&&!E&&I.length&&!s){var ce=I[0],_e=Object.create(null),ge=new Set(ce);let we=!1;for(let Ae=0;Ae<ce.length;Ae++){let ke=ce[Ae];if(_e[ke=Q(e.transformHeader)?e.transformHeader(ke,Ae):ke]){let De,Ce=_e[ke];for(;De=ke+"_"+Ce,Ce++,ge.has(De););ge.add(De),ce[Ae]=De,_e[ke]++,we=!0,(p=p===null?{}:p)[De]=ke}else _e[ke]=1,ce[Ae]=ke;ge.add(ke)}we&&console.warn("Duplicate headers found and renamed."),s=!0}return{data:I,errors:u,meta:{delimiter:t,linebreak:i,aborted:M,truncated:!!X,cursor:J+(E||0),renamedHeaders:p}}}function ye(){m(se()),I=[],u=[]}},this.abort=function(){M=!0},this.getCharIndex=function(){return c}}function he(e){var t=e.data,i=U[t.workerId],h=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var m={abort:function(){h=!0,le(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:B,resume:B};if(Q(i.userStep)){for(var _=0;_<t.results.data.length&&(i.userStep({data:t.results.data[_],errors:t.results.errors,meta:t.results.meta},m),!h);_++);delete t.results}else Q(i.userChunk)&&(i.userChunk(t.results,m,t.file),delete t.results)}t.finished&&!h&&le(t.workerId,t.results)}function le(e,t){var i=U[e];Q(i.userComplete)&&i.userComplete(t),i.terminate(),delete U[e]}function B(){throw new Error("Not implemented.")}function W(e){if(typeof e!="object"||e===null)return e;var t,i=Array.isArray(e)?[]:{};for(t in e)i[t]=W(e[t]);return i}function Se(e,t){return function(){e.apply(t,arguments)}}function Q(e){return typeof e=="function"}return g.parse=function(e,t){var i=(t=t||{}).dynamicTyping||!1;if(Q(i)&&(t.dynamicTypingFunction=i,i={}),t.dynamicTyping=i,t.transform=!!Q(t.transform)&&t.transform,!t.worker||!g.WORKERS_SUPPORTED)return i=null,g.NODE_STREAM_INPUT,typeof e=="string"?(e=(h=>h.charCodeAt(0)!==65279?h:h.slice(1))(e),i=new(t.download?Y:z)(t)):e.readable===!0&&Q(e.read)&&Q(e.on)?i=new P(t):(f.File&&e instanceof File||e instanceof Object)&&(i=new D(t)),i.stream(e);(i=(()=>{var h;return!!g.WORKERS_SUPPORTED&&(h=(()=>{var m=f.URL||f.webkitURL||null,_=o.toString();return g.BLOB_URL||(g.BLOB_URL=m.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",_,")();"],{type:"text/javascript"})))})(),(h=new f.Worker(h)).onmessage=he,h.id=q++,U[h.id]=h)})()).userStep=t.step,i.userChunk=t.chunk,i.userComplete=t.complete,i.userError=t.error,t.step=Q(t.step),t.chunk=Q(t.chunk),t.complete=Q(t.complete),t.error=Q(t.error),delete t.worker,i.postMessage({input:e,config:t,workerId:i.id})},g.unparse=function(e,t){var i=!1,h=!0,m=",",_=`\r
`,j='"',p=j+j,s=!1,d=null,k=!1,c=((()=>{if(typeof t=="object"){if(typeof t.delimiter!="string"||g.BAD_DELIMITERS.filter(function(E){return t.delimiter.indexOf(E)!==-1}).length||(m=t.delimiter),typeof t.quotes!="boolean"&&typeof t.quotes!="function"&&!Array.isArray(t.quotes)||(i=t.quotes),typeof t.skipEmptyLines!="boolean"&&typeof t.skipEmptyLines!="string"||(s=t.skipEmptyLines),typeof t.newline=="string"&&(_=t.newline),typeof t.quoteChar=="string"&&(j=t.quoteChar),typeof t.header=="boolean"&&(h=t.header),Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");d=t.columns}t.escapeChar!==void 0&&(p=t.escapeChar+j),t.escapeFormulae instanceof RegExp?k=t.escapeFormulae:typeof t.escapeFormulae=="boolean"&&t.escapeFormulae&&(k=/^[=+\-@\t\r].*$/)}})(),new RegExp(oe(j),"g"));if(typeof e=="string"&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return M(null,e,s);if(typeof e[0]=="object")return M(d||Object.keys(e[0]),e,s)}else if(typeof e=="object")return typeof e.data=="string"&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||d),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]=="object"?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||typeof e.data[0]=="object"||(e.data=[e.data])),M(e.fields||[],e.data||[],s);throw new Error("Unable to serialize unrecognized input");function M(E,l,x){var O="",N=(typeof E=="string"&&(E=JSON.parse(E)),typeof l=="string"&&(l=JSON.parse(l)),Array.isArray(E)&&0<E.length),K=!Array.isArray(l[0]);if(N&&h){for(var C=0;C<E.length;C++)0<C&&(O+=m),O+=v(E[C],C);0<l.length&&(O+=_)}for(var I=0;I<l.length;I++){var u=(N?E:l[I]).length,w=!1,J=N?Object.keys(l[I]).length===0:l[I].length===0;if(x&&!N&&(w=x==="greedy"?l[I].join("").trim()==="":l[I].length===1&&l[I][0].length===0),x==="greedy"&&N){for(var re=[],G=0;G<u;G++){var V=K?E[G]:G;re.push(l[I][V])}w=re.join("").trim()===""}if(!w){for(var H=0;H<u;H++){0<H&&!J&&(O+=m);var me=N&&K?E[H]:H;O+=v(l[I][me],H)}I<l.length-1&&(!x||0<u&&!J)&&(O+=_)}}return O}function v(E,l){var x,O;return E==null?"":E.constructor===Date?JSON.stringify(E).slice(1,25):(O=!1,k&&typeof E=="string"&&k.test(E)&&(E="'"+E,O=!0),x=E.toString().replace(c,p),(O=O||i===!0||typeof i=="function"&&i(E,l)||Array.isArray(i)&&i[l]||((N,K)=>{for(var C=0;C<K.length;C++)if(-1<N.indexOf(K[C]))return!0;return!1})(x,g.BAD_DELIMITERS)||-1<x.indexOf(m)||x.charAt(0)===" "||x.charAt(x.length-1)===" ")?j+x+j:x)}},g.RECORD_SEP="",g.UNIT_SEP="",g.BYTE_ORDER_MARK="\uFEFF",g.BAD_DELIMITERS=["\r",`
`,'"',g.BYTE_ORDER_MARK],g.WORKERS_SUPPORTED=!b&&!!f.Worker,g.NODE_STREAM_INPUT=1,g.LocalChunkSize=10485760,g.RemoteChunkSize=5242880,g.DefaultDelimiter=",",g.Parser=ue,g.ParserHandle=Ee,g.NetworkStreamer=Y,g.FileStreamer=D,g.StringStreamer=z,g.ReadableStreamStreamer=P,f.jQuery&&((y=f.jQuery).fn.parse=function(e){var t=e.config||{},i=[];return this.each(function(_){if(!(y(this).prop("tagName").toUpperCase()==="INPUT"&&y(this).attr("type").toLowerCase()==="file"&&f.FileReader)||!this.files||this.files.length===0)return!0;for(var j=0;j<this.files.length;j++)i.push({file:this.files[j],inputElem:this,instanceConfig:y.extend({},t)})}),h(),this;function h(){if(i.length===0)Q(e.complete)&&e.complete();else{var _,j,p,s,d=i[0];if(Q(e.before)){var k=e.before(d.file,d.inputElem);if(typeof k=="object"){if(k.action==="abort")return _="AbortError",j=d.file,p=d.inputElem,s=k.reason,void(Q(e.error)&&e.error({name:_},j,p,s));if(k.action==="skip")return void m();typeof k.config=="object"&&(d.instanceConfig=y.extend(d.instanceConfig,k.config))}else if(k==="skip")return void m()}var c=d.instanceConfig.complete;d.instanceConfig.complete=function(M){Q(c)&&c(M,d.file,d.inputElem),m()},g.parse(d.file,d.instanceConfig)}}function m(){i.splice(0,1),h()}}),F&&(f.onmessage=function(e){e=e.data,g.WORKER_ID===void 0&&e&&(g.WORKER_ID=e.workerId),typeof e.input=="string"?f.postMessage({workerId:g.WORKER_ID,results:g.parse(e.input,e.config),finished:!0}):(f.File&&e.input instanceof File||e.input instanceof Object)&&(e=g.parse(e.input,e.config))&&f.postMessage({workerId:g.WORKER_ID,results:e,finished:!0})}),(Y.prototype=Object.create(A.prototype)).constructor=Y,(D.prototype=Object.create(A.prototype)).constructor=D,(z.prototype=Object.create(z.prototype)).constructor=z,(P.prototype=Object.create(A.prototype)).constructor=P,g})}(Qe)),Qe.exports}var Er=xr();const Sr=br(Er);var Cr=te('<li class="svelte-bfi8cr"> </li>'),Rr=te('<ul class="suggestions svelte-bfi8cr"></ul>'),Or=te('<img alt="Product" width="80" class="svelte-bfi8cr">'),wr=te("<i>No image</i>"),Dr=te('<tr><td class="svelte-bfi8cr"><!></td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"> </td><td class="svelte-bfi8cr"><input type="number" min="0" step="1" style="width: 80px" class="svelte-bfi8cr"> <span> </span></td><td class="svelte-bfi8cr"><button>Del</button></td></tr>'),Lr=te('<img width="60" alt="Image" class="svelte-bfi8cr">'),Ir=te("<i>No image</i>"),Ar=te("<option> </option>"),Tr=te('<td class="svelte-bfi8cr"><!></td> <td class="svelte-bfi8cr"> </td> <td class="svelte-bfi8cr"> <strong> </strong></td> <td class="svelte-bfi8cr"><select><option> </option><!></select></td>',1),Nr=te('<td colspan="3" class="svelte-bfi8cr"><i>Not available</i></td>'),Fr=te('<img width="60" alt="Image" class="svelte-bfi8cr">'),Mr=te("<i>No image</i>"),Pr=te("<option> </option>"),$r=te('<td class="svelte-bfi8cr"><!></td> <td class="svelte-bfi8cr"> </td> <td class="svelte-bfi8cr"> <strong> </strong></td> <td class="svelte-bfi8cr"><select><option> </option><!></select></td>',1),Kr=te('<td colspan="4" class="svelte-bfi8cr"><i>Not available</i></td>'),Ur=te('<tr><td class="svelte-bfi8cr"> </td><!><!></tr>'),qr=te('<table class="product-table svelte-bfi8cr"><thead><tr><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Category</th><th class="svelte-bfi8cr">Price Range</th><th class="svelte-bfi8cr">Price per Unit</th><th class="svelte-bfi8cr">Quantity</th><th class="svelte-bfi8cr"></th></tr></thead><tbody></tbody></table> <table class="comparison-table svelte-bfi8cr"><thead><tr><th rowspan="2" class="svelte-bfi8cr">Product</th><th colspan="4" class="svelte-bfi8cr">Rema1000</th><th colspan="4" class="svelte-bfi8cr">Coop</th></tr><tr><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Product</th><th class="svelte-bfi8cr">Price × Qty</th><th class="svelte-bfi8cr"></th><th class="svelte-bfi8cr">Image</th><th class="svelte-bfi8cr">Product</th><th class="svelte-bfi8cr">Price × Qty</th><th class="svelte-bfi8cr"></th></tr></thead><tbody><!><tr><th class="svelte-bfi8cr">Total</th><td colspan="3" class="svelte-bfi8cr"></td><td class="svelte-bfi8cr"><strong> </strong></td><td colspan="3" class="svelte-bfi8cr"></td><td class="svelte-bfi8cr"><strong> </strong></td></tr></tbody></table>',1),zr=te("<option> </option>"),Br=te('<div class="basket-controls svelte-bfi8cr"><select><option disabled selected>Select saved basket</option><!></select> <button>Load Basket</button> <button>Delete Basket</button></div>'),jr=te('<div class="autocomplete svelte-bfi8cr"><input type="text" placeholder="Add grocery category..." class="svelte-bfi8cr"> <!></div> <!> <hr> <h3>Manage Baskets</h3> <div class="basket-controls svelte-bfi8cr"><input type="text" placeholder="Basket name (e.g. Week 22)" class="svelte-bfi8cr"> <button>Save Current Basket</button></div> <!>',1);function Hr(r,n){Ye(n,!1);const o=Re();let f=[],y=Re(""),b=Re([]),F=[],U=[],q=Re([]),A=Re([{name:"Last Week",items:[{category:"Milk",img:"",priceRange:"",perUnitDisplay:"",unit:"l",quantity:2,manualOverrides:{rema:null,coop:null}},{category:"Beef",img:"",priceRange:"",perUnitDisplay:"",unit:"kg",quantity:.5,manualOverrides:{rema:null,coop:null}},{category:"Yogurt",img:"",priceRange:"",perUnitDisplay:"",unit:"kg",quantity:1,manualOverrides:{rema:null,coop:null}}]}]),Y=Re(""),D=Re(null);st(async()=>{const s=await(await fetch("/scraper/export/combined_data_final_priced.csv")).text();U=Sr.parse(s,{header:!0,skipEmptyLines:!0}).data;const k=new Set;for(const c of U)c["Best Category"]&&k.add(c["Best Category"].trim());f=Array.from(k).sort()});function z(){if(a(y).length<1){fe(b,[]);return}const p=a(y).toLowerCase();fe(b,f.filter(s=>s.toLowerCase().includes(p)&&!F.includes(s)).slice(0,10))}function P(p){F=[...F,p],fe(y,""),fe(b,[]);const s=U.filter(d=>{var k;return((k=d["Best Category"])==null?void 0:k.trim())===p});if(s.length>0){const d=s.map(N=>parseFloat(N.Price)).filter(N=>!isNaN(N)),k=Math.min(...d),c=Math.max(...d),M=k===c?`${k.toFixed(2)} DKK`:`${k.toFixed(2)}–${c.toFixed(2)} DKK`,v=s.find(N=>N.Img),E=["l","kg","other",""];let l="",x=[];for(const N of E)if(x=s.filter(K=>(K["Unit Standardized"]||"").trim().toLowerCase()===N).map(K=>parseFloat(K["Price per Unit"])).filter(K=>!isNaN(K)),x.length>0){l=N;break}let O="N/A";if(x.length>0){const N=Math.min(...x),K=Math.max(...x),C=l==="l"?"DKK/L":l==="kg"?"DKK/kg":"DKK/piece";O=N===K?`${N.toFixed(2)} ${C}`:`${N.toFixed(2)}–${K.toFixed(2)} ${C}`}fe(q,[...a(q),{category:p,img:(v==null?void 0:v.Img)||"",priceRange:M,perUnitDisplay:O,unit:l,quantity:1,manualOverrides:{rema:null,coop:null}}])}}function Ee(p){F=F.filter(s=>s!==p),fe(q,a(q).filter(s=>s.category!==p))}function oe(p,s,d,k){const M=[s,...["l","kg","other",""].filter(v=>v!==s)];for(const v of M){const l=U.filter(x=>{var O,N;return((O=x["Best Category"])==null?void 0:O.trim())===p&&((N=x.Retail)==null?void 0:N.trim())===k&&(x["Unit Standardized"]||"").trim().toLowerCase()===v}).map(x=>{const O=parseFloat(x["Quantity (Standardized)"]),N=parseFloat(x.Price),K=x.Name.charAt(0)+x.Name.toLowerCase().slice(1),C=x.Img,I=x["Quantity (Standardized)"];if(isNaN(O)||isNaN(N))return null;const u=d/O,w=Math.ceil(u),J=w*N;return{name:K,unitSize:O,unitsToBuy:w,pricePerUnit:N,totalPrice:J,img:C,packSize:I,unit:v}}).filter(Boolean);if(l.length>0)return l.reduce((x,O)=>x.totalPrice<O.totalPrice?x:O)}return null}function ue(p,s,d){const c=[s,...["l","kg","other",""].filter(M=>M!==s)];for(const M of c){const E=U.filter(l=>{var x,O;return((x=l["Best Category"])==null?void 0:x.trim())===p&&((O=l.Retail)==null?void 0:O.trim())===d&&(l["Unit Standardized"]||"").trim().toLowerCase()===M}).map(l=>{const x=parseFloat(l["Quantity (Standardized)"]),O=parseFloat(l.Price),N=l.Name,K=l.Img,C=l.Quantity;return isNaN(x)||isNaN(O)?null:{name:N,unit:M,unitQty:x,price:O,img:K,packSize:C}}).filter(Boolean);if(E.length>0)return E}return[]}async function he(p){fe(q,[]);for(const s of p){const d=U.filter(K=>{var C;return((C=K["Best Category"])==null?void 0:C.trim())===s.category});if(d.length===0)continue;const k=d.map(K=>parseFloat(K.Price)).filter(K=>!isNaN(K)),c=Math.min(...k),M=Math.max(...k),v=c===M?`${c.toFixed(2)} DKK`:`${c.toFixed(2)}–${M.toFixed(2)} DKK`,E=d.find(K=>K.Img),l=["l","kg","other",""];let x="",O=[];for(const K of l)if(O=d.filter(C=>(C["Unit Standardized"]||"").trim().toLowerCase()===K).map(C=>parseFloat(C["Price per Unit"])).filter(C=>!isNaN(C)),O.length>0){x=K;break}let N="N/A";if(O.length>0){const K=Math.min(...O),C=Math.max(...O),I=x==="l"?"DKK/L":x==="kg"?"DKK/kg":"DKK/piece";N=K===C?`${K.toFixed(2)} ${I}`:`${K.toFixed(2)}–${C.toFixed(2)} ${I}`}a(q).push({category:s.category,img:(E==null?void 0:E.Img)||"",priceRange:v,perUnitDisplay:N,unit:x,quantity:s.quantity,manualOverrides:{rema:null,coop:null}})}}Et(()=>a(q),()=>{fe(o,a(q).map((p,s)=>{const d=p.manualOverrides.rema,k=p.manualOverrides.coop,c=(M,v)=>{if(v){const E=Math.ceil(p.quantity/v.unitQty);return{name:v.name,unit:v.unit,pricePerUnit:v.price,unitsToBuy:E,totalPrice:E*v.price,img:v.img,packSize:v.packSize}}return oe(p.category,p.unit,p.quantity,M)};return{index:s,category:p.category,quantity:p.quantity,unit:p.unit,rema:c("Rema1000",d),coop:c("Coop",k)}}))}),St(),Ge();var le=jr(),B=ze(le),W=R(B);je(W);var Se=T(W,2);{var Q=p=>{var s=Rr();Ue(s,5,()=>a(b),Ke,(d,k)=>{var c=Cr(),M=R(c,!0);S(c),xe(()=>de(M,a(k))),Ne("click",c,()=>P(a(k))),ee(d,c)}),S(s),ee(p,s)};Te(Se,p=>{a(b).length>0&&p(Q)})}S(B);var e=T(B,2);{var t=p=>{var s=qr(),d=ze(s),k=T(R(d));Ue(k,5,()=>a(q),Ke,(I,u,w)=>{var J=Dr(),re=R(J),G=R(re);{var V=ge=>{var we=Or();xe(()=>Pe(we,"src",a(u).img)),ee(ge,we)},H=ge=>{var we=wr();ee(ge,we)};Te(G,ge=>{a(u).img?ge(V):ge(H,!1)})}S(re);var me=T(re),$=R(me,!0);S(me);var Z=T(me),ne=R(Z,!0);S(Z);var pe=T(Z),ve=R(pe,!0);S(pe);var Oe=T(pe),se=R(Oe);je(se);var ye=T(se,2),X=R(ye,!0);S(ye),S(Oe);var ce=T(Oe),_e=R(ce);S(ce),S(J),xe(()=>{de($,a(u).category),de(ne,a(u).priceRange),de(ve,a(u).perUnitDisplay),de(X,a(u).unit==="l"?"liters":a(u).unit==="kg"?"kg":"pcs")}),He(se,()=>a(u).quantity,ge=>(a(u).quantity=ge,dt(()=>a(q)))),Ne("click",_e,()=>Ee(a(u).category)),ee(I,J)}),S(k),S(d);var c=T(d,2),M=T(R(c)),v=R(M);Ue(v,1,()=>a(o),Ke,(I,u)=>{var w=Ur(),J=R(w),re=R(J,!0);S(J);var G=T(J);{var V=ne=>{var pe=Tr(),ve=ze(pe),Oe=R(ve);{var se=ae=>{var ie=Lr();xe(()=>Pe(ie,"src",a(u).rema.img)),ee(ae,ie)},ye=ae=>{var ie=Ir();ee(ae,ie)};Te(Oe,ae=>{a(u).rema.img?ae(se):ae(ye,!1)})}S(ve);var X=T(ve,2),ce=R(X);S(X);var _e=T(X,2),ge=R(_e),we=T(ge),Ae=R(we);S(we),S(_e);var ke=T(_e,2),De=R(ke),Ce=R(De);Ce.value=(Ce.__value=null)==null?"":null;var Ve=R(Ce);S(Ce);var Ze=T(Ce);Ue(Ze,1,()=>ue(a(u).category,a(u).unit,"Rema1000"),Ke,(ae,ie)=>{var be=Ar(),Ie={},Fe=R(be);S(be),xe($e=>{Ie!==(Ie=$e)&&(be.value=(be.__value=$e)==null?"":$e),de(Fe,`${a(ie).name??""} – ${a(ie).packSize??""}${a(ie).unit??""} (${a(ie).price??""} DKK)`)},[()=>JSON.stringify(a(ie))],qe),ee(ae,be)}),S(De),S(ke),xe((ae,ie)=>{var be,Ie,Fe;de(ce,`${a(u).rema.name??""}, ${a(u).rema.packSize??""}${a(u).rema.unit??""}`),de(ge,`${ae??""} DKK × ${a(u).rema.unitsToBuy??""} = `),de(Ae,`${ie??""} DKK`),de(Ve,`Auto: ${((be=a(u).rema)==null?void 0:be.name)??""} (${((Ie=a(u).rema)==null?void 0:Ie.packSize)??""}${((Fe=a(u).rema)==null?void 0:Fe.unit)??""})`)},[()=>a(u).rema.pricePerUnit.toFixed(2),()=>a(u).rema.totalPrice.toFixed(2)],qe),Ne("change",De,ae=>ft(q,a(q)[a(u).index].manualOverrides.rema=JSON.parse(ae.target.value))),ee(ne,pe)},H=ne=>{var pe=Nr();ee(ne,pe)};Te(G,ne=>{a(u).rema?ne(V):ne(H,!1)})}var me=T(G);{var $=ne=>{var pe=$r(),ve=ze(pe),Oe=R(ve);{var se=ae=>{var ie=Fr();xe(()=>Pe(ie,"src",a(u).coop.img)),ee(ae,ie)},ye=ae=>{var ie=Mr();ee(ae,ie)};Te(Oe,ae=>{a(u).coop.img?ae(se):ae(ye,!1)})}S(ve);var X=T(ve,2),ce=R(X);S(X);var _e=T(X,2),ge=R(_e),we=T(ge),Ae=R(we);S(we),S(_e);var ke=T(_e,2),De=R(ke),Ce=R(De);Ce.value=(Ce.__value=null)==null?"":null;var Ve=R(Ce);S(Ce);var Ze=T(Ce);Ue(Ze,1,()=>ue(a(u).category,a(u).unit,"Coop"),Ke,(ae,ie)=>{var be=Pr(),Ie={},Fe=R(be);S(be),xe($e=>{Ie!==(Ie=$e)&&(be.value=(be.__value=$e)==null?"":$e),de(Fe,`${a(ie).name??""} – ${a(ie).packSize??""}${a(ie).unit??""} (${a(ie).price??""} DKK)`)},[()=>JSON.stringify(a(ie))],qe),ee(ae,be)}),S(De),S(ke),xe((ae,ie)=>{var be,Ie,Fe;de(ce,`${a(u).coop.name??""}, ${a(u).coop.packSize??""}${a(u).coop.unit??""}`),de(ge,`${ae??""} DKK × ${a(u).coop.unitsToBuy??""} = `),de(Ae,`${ie??""} DKK`),de(Ve,`Auto: ${((be=a(u).coop)==null?void 0:be.name)??""} (${((Ie=a(u).coop)==null?void 0:Ie.packSize)??""}${((Fe=a(u).coop)==null?void 0:Fe.unit)??""})`)},[()=>a(u).coop.pricePerUnit.toFixed(2),()=>a(u).coop.totalPrice.toFixed(2)],qe),Ne("change",De,ae=>ft(q,a(q)[a(u).index].manualOverrides.coop=JSON.parse(ae.target.value))),ee(ne,pe)},Z=ne=>{var pe=Kr();ee(ne,pe)};Te(me,ne=>{a(u).coop?ne($):ne(Z,!1)})}S(w),xe(()=>de(re,a(u).category)),ee(I,w)});var E=T(v),l=T(R(E),2),x=R(l),O=R(x);S(x),S(l);var N=T(l,2),K=R(N),C=R(K);S(K),S(N),S(E),S(M),S(c),xe((I,u)=>{de(O,`${I??""} DKK`),de(C,`${u??""} DKK`)},[()=>a(o).map(I=>{var u;return((u=I.rema)==null?void 0:u.totalPrice)||0}).reduce((I,u)=>I+u,0).toFixed(2),()=>a(o).map(I=>{var u;return((u=I.coop)==null?void 0:u.totalPrice)||0}).reduce((I,u)=>I+u,0).toFixed(2)],qe),ee(p,s)};Te(e,p=>{a(q).length>0&&p(t)})}var i=T(e,6),h=R(i);je(h);var m=T(h,2);S(i);var _=T(i,2);{var j=p=>{var s=Br(),d=R(s);xe(()=>{a(D),dt(()=>{a(A)})});var k=R(d);k.value=(k.__value=null)==null?"":null;var c=T(k);Ue(c,1,()=>a(A),Ke,(E,l,x)=>{var O=zr();O.value=(O.__value=x)==null?"":x;var N=R(O,!0);S(O),xe(()=>de(N,a(l).name)),ee(E,O)}),S(d);var M=T(d,2),v=T(M,2);S(s),fr(d,()=>a(D),E=>fe(D,E)),Ne("click",M,()=>{a(D)!==null&&he(a(A)[a(D)].items)}),Ne("click",v,()=>{a(D)!==null&&(a(A).splice(a(D),1),fe(D,null))}),ee(p,s)};Te(_,p=>{a(A).length>0&&p(j)})}He(W,()=>a(y),p=>fe(y,p)),Ne("input",W,z),He(h,()=>a(Y),p=>fe(Y,p)),Ne("click",m,()=>{!a(Y)||a(q).length===0||(fe(A,[...a(A),{name:a(Y),items:JSON.parse(JSON.stringify(a(q)))}]),fe(Y,""))}),ee(r,le),Je()}var Wr=te(`<div class="savings-progress svelte-13kv8p7"><div class="savings-label svelte-13kv8p7">You've saved <strong></strong> this month out of your <strong></strong> goal!</div> <div class="progress-bar svelte-13kv8p7"><div class="progress-bar__fill svelte-13kv8p7"></div></div> <div class="progress-label svelte-13kv8p7"> </div></div>`);function Qr(r,n){Ye(n,!1);const o=Re();let f=200,y=110;Et(()=>{},()=>{fe(o,Math.min(y/f*100,100).toFixed(0))}),St(),Ge();var b=Wr(),F=R(b),U=T(R(F));U.textContent=`${y} DKK`;var q=T(U,2);q.textContent=`${f} DKK`,xt(),S(F);var g=T(F,2),A=R(g);S(g);var Y=T(g,2),D=R(Y);S(Y),S(b),xe(()=>{sr(A,`width: ${a(o)??""}%`),de(D,`${a(o)??""}%`)}),ee(r,b),Je()}var Yr=te('<div class="header"><h1 class="svelte-14u9xq7"></h1> <h2 class="svelte-14u9xq7">Here is the overview of Your Shopping:</h2> <!></div> <div class="col-2"><div class="col-2-left"><h2 class="svelte-14u9xq7">Shopping List</h2> <!></div></div> <div class="col-1"><h2 class="svelte-14u9xq7">Nearby Stores</h2> <!></div>',1);function ia(r,n){Ye(n,!1);let o="Daniel";st(()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(z=>{z.coords.latitude,z.coords.longitude})});function f({start:z,end:P}){}Ge();var y=Yr(),b=ze(y),F=R(b);F.textContent=`Hi ${o},`;var U=T(F,4);Qr(U,{}),S(b);var q=T(b,2),g=R(q),A=T(R(g),2);Hr(A,{}),S(g),S(q);var Y=T(q,2),D=T(R(Y),2);yr(D,{onRouteCreated:f}),S(Y),ee(r,y),Je()}export{ia as _,aa as c,br as g};
